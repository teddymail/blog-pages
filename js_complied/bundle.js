!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";function t(t){return Array.isArray?Array.isArray(t):"[object Array]"===l(t)}const e=1/0;function n(t){return null==t?"":function(t){if("string"==typeof t)return t;let n=t+"";return"0"==n&&1/t==-e?"-0":n}(t)}function s(t){return"string"==typeof t}function i(t){return"number"==typeof t}function r(t){return!0===t||!1===t||function(t){return o(t)&&null!==t}(t)&&"[object Boolean]"==l(t)}function o(t){return"object"==typeof t}function a(t){return null!=t}function c(t){return!t.trim().length}function l(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const h=t=>`Missing ${t} property in key`,u=t=>`Property 'weight' in key '${t}' must be a positive integer`,d=Object.prototype.hasOwnProperty;class g{constructor(t){this._keys=[],this._keyMap={};let e=0;t.forEach((t=>{let n=f(t);this._keys.push(n),this._keyMap[n.id]=n,e+=n.weight})),this._keys.forEach((t=>{t.weight/=e}))}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function f(e){let n=null,i=null,r=null,o=1,a=null;if(s(e)||t(e))r=e,n=m(e),i=p(e);else{if(!d.call(e,"name"))throw new Error(h("name"));const t=e.name;if(r=t,d.call(e,"weight")&&(o=e.weight,o<=0))throw new Error(u(t));n=m(t),i=p(t),a=e.getFn}return{path:n,id:i,weight:o,src:r,getFn:a}}function m(e){return t(e)?e:e.split(".")}function p(e){return t(e)?e.join("."):e}var w={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1,includeMatches:!1,findAllMatches:!1,minMatchCharLength:1,location:0,threshold:.6,distance:100,...{useExtendedSearch:!1,getFn:function(e,o){let c=[],l=!1;const h=(e,o,u)=>{if(a(e))if(o[u]){const d=e[o[u]];if(!a(d))return;if(u===o.length-1&&(s(d)||i(d)||r(d)))c.push(n(d));else if(t(d)){l=!0;for(let t=0,e=d.length;t<e;t+=1)h(d[t],o,u+1)}else o.length&&h(d,o,u+1)}else c.push(e)};return h(e,s(o)?o.split("."):o,0),l?c:c[0]},ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1}};const y=/[^ ]+/g;class v{constructor({getFn:t=w.getFn,fieldNormWeight:e=w.fieldNormWeight}={}){this.norm=function(t=1,e=3){const n=new Map,s=Math.pow(10,e);return{get(e){const i=e.match(y).length;if(n.has(i))return n.get(i);const r=1/Math.pow(i,.5*t),o=parseFloat(Math.round(r*s)/s);return n.set(i,o),o},clear(){n.clear()}}}(e,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach(((t,e)=>{this._keysMap[t.id]=e}))}create(){!this.isCreated&&this.docs.length&&(this.isCreated=!0,s(this.docs[0])?this.docs.forEach(((t,e)=>{this._addString(t,e)})):this.docs.forEach(((t,e)=>{this._addObject(t,e)})),this.norm.clear())}add(t){const e=this.size();s(t)?this._addString(t,e):this._addObject(t,e)}removeAt(t){this.records.splice(t,1);for(let e=t,n=this.size();e<n;e+=1)this.records[e].i-=1}getValueForItemAtKeyId(t,e){return t[this._keysMap[e]]}size(){return this.records.length}_addString(t,e){if(!a(t)||c(t))return;let n={v:t,i:e,n:this.norm.get(t)};this.records.push(n)}_addObject(e,n){let i={i:n,$:{}};this.keys.forEach(((n,r)=>{let o=n.getFn?n.getFn(e):this.getFn(e,n.path);if(a(o))if(t(o)){let e=[];const n=[{nestedArrIndex:-1,value:o}];for(;n.length;){const{nestedArrIndex:i,value:r}=n.pop();if(a(r))if(s(r)&&!c(r)){let t={v:r,i:i,n:this.norm.get(r)};e.push(t)}else t(r)&&r.forEach(((t,e)=>{n.push({nestedArrIndex:e,value:t})}))}i.$[r]=e}else if(s(o)&&!c(o)){let t={v:o,n:this.norm.get(o)};i.$[r]=t}})),this.records.push(i)}toJSON(){return{keys:this.keys,records:this.records}}}function k(t,e,{getFn:n=w.getFn,fieldNormWeight:s=w.fieldNormWeight}={}){const i=new v({getFn:n,fieldNormWeight:s});return i.setKeys(t.map(f)),i.setSources(e),i.create(),i}function x(t,{errors:e=0,currentLocation:n=0,expectedLocation:s=0,distance:i=w.distance,ignoreLocation:r=w.ignoreLocation}={}){const o=e/t.length;if(r)return o;const a=Math.abs(s-n);return i?o+a/i:a?1:o}const _=32;function M(t,e,n,{location:s=w.location,distance:i=w.distance,threshold:r=w.threshold,findAllMatches:o=w.findAllMatches,minMatchCharLength:a=w.minMatchCharLength,includeMatches:c=w.includeMatches,ignoreLocation:l=w.ignoreLocation}={}){if(e.length>_)throw new Error(`Pattern length exceeds max of ${_}.`);const h=e.length,u=t.length,d=Math.max(0,Math.min(s,u));let g=r,f=d;const m=a>1||c,p=m?Array(u):[];let y;for(;(y=t.indexOf(e,f))>-1;){let t=x(e,{currentLocation:y,expectedLocation:d,distance:i,ignoreLocation:l});if(g=Math.min(t,g),f=y+h,m){let t=0;for(;t<h;)p[y+t]=1,t+=1}}f=-1;let v=[],k=1,M=h+u;const L=1<<h-1;for(let s=0;s<h;s+=1){let r=0,a=M;for(;r<a;){x(e,{errors:s,currentLocation:d+a,expectedLocation:d,distance:i,ignoreLocation:l})<=g?r=a:M=a,a=Math.floor((M-r)/2+r)}M=a;let c=Math.max(1,d-a+1),w=o?u:Math.min(d+a,u)+h,y=Array(w+2);y[w+1]=(1<<s)-1;for(let r=w;r>=c;r-=1){let o=r-1,a=n[t.charAt(o)];if(m&&(p[o]=+!!a),y[r]=(y[r+1]<<1|1)&a,s&&(y[r]|=(v[r+1]|v[r])<<1|1|v[r+1]),y[r]&L&&(k=x(e,{errors:s,currentLocation:o,expectedLocation:d,distance:i,ignoreLocation:l}),k<=g)){if(g=k,f=o,f<=d)break;c=Math.max(1,2*d-f)}}if(x(e,{errors:s+1,currentLocation:d,expectedLocation:d,distance:i,ignoreLocation:l})>g)break;v=y}const S={isMatch:f>=0,score:Math.max(.001,k)};if(m){const t=function(t=[],e=w.minMatchCharLength){let n=[],s=-1,i=-1,r=0;for(let o=t.length;r<o;r+=1){let o=t[r];o&&-1===s?s=r:o||-1===s||(i=r-1,i-s+1>=e&&n.push([s,i]),s=-1)}return t[r-1]&&r-s>=e&&n.push([s,r-1]),n}(p,a);t.length?c&&(S.indices=t):S.isMatch=!1}return S}function L(t){let e={};for(let n=0,s=t.length;n<s;n+=1){const i=t.charAt(n);e[i]=(e[i]||0)|1<<s-n-1}return e}class S{constructor(t,{location:e=w.location,threshold:n=w.threshold,distance:s=w.distance,includeMatches:i=w.includeMatches,findAllMatches:r=w.findAllMatches,minMatchCharLength:o=w.minMatchCharLength,isCaseSensitive:a=w.isCaseSensitive,ignoreLocation:c=w.ignoreLocation}={}){if(this.options={location:e,threshold:n,distance:s,includeMatches:i,findAllMatches:r,minMatchCharLength:o,isCaseSensitive:a,ignoreLocation:c},this.pattern=a?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;const l=(t,e)=>{this.chunks.push({pattern:t,alphabet:L(t),startIndex:e})},h=this.pattern.length;if(h>_){let t=0;const e=h%_,n=h-e;for(;t<n;)l(this.pattern.substr(t,_),t),t+=_;if(e){const t=h-_;l(this.pattern.substr(t),t)}}else l(this.pattern,0)}searchIn(t){const{isCaseSensitive:e,includeMatches:n}=this.options;if(e||(t=t.toLowerCase()),this.pattern===t){let e={isMatch:!0,score:0};return n&&(e.indices=[[0,t.length-1]]),e}const{location:s,distance:i,threshold:r,findAllMatches:o,minMatchCharLength:a,ignoreLocation:c}=this.options;let l=[],h=0,u=!1;this.chunks.forEach((({pattern:e,alphabet:d,startIndex:g})=>{const{isMatch:f,score:m,indices:p}=M(t,e,d,{location:s+g,distance:i,threshold:r,findAllMatches:o,minMatchCharLength:a,includeMatches:n,ignoreLocation:c});f&&(u=!0),h+=m,f&&p&&(l=[...l,...p])}));let d={isMatch:u,score:u?h/this.chunks.length:1};return u&&n&&(d.indices=l),d}}class E{constructor(t){this.pattern=t}static isMultiMatch(t){return b(t,this.multiRegex)}static isSingleMatch(t){return b(t,this.singleRegex)}search(){}}function b(t,e){const n=t.match(e);return n?n[1]:null}class C extends E{constructor(t,{location:e=w.location,threshold:n=w.threshold,distance:s=w.distance,includeMatches:i=w.includeMatches,findAllMatches:r=w.findAllMatches,minMatchCharLength:o=w.minMatchCharLength,isCaseSensitive:a=w.isCaseSensitive,ignoreLocation:c=w.ignoreLocation}={}){super(t),this._bitapSearch=new S(t,{location:e,threshold:n,distance:s,includeMatches:i,findAllMatches:r,minMatchCharLength:o,isCaseSensitive:a,ignoreLocation:c})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class I extends E{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let e,n=0;const s=[],i=this.pattern.length;for(;(e=t.indexOf(this.pattern,n))>-1;)n=e+i,s.push([e,n-1]);const r=!!s.length;return{isMatch:r,score:r?0:1,indices:s}}}const A=[class extends E{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const e=t===this.pattern;return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}},I,class extends E{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const e=t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}},class extends E{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const e=!t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}},class extends E{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const e=!t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}},class extends E{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const e=t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[t.length-this.pattern.length,t.length-1]}}},class extends E{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const e=-1===t.indexOf(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}},C],T=A.length,R=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/;const $=new Set([C.type,I.type]);class N{constructor(t,{isCaseSensitive:e=w.isCaseSensitive,includeMatches:n=w.includeMatches,minMatchCharLength:s=w.minMatchCharLength,ignoreLocation:i=w.ignoreLocation,findAllMatches:r=w.findAllMatches,location:o=w.location,threshold:a=w.threshold,distance:c=w.distance}={}){this.query=null,this.options={isCaseSensitive:e,includeMatches:n,minMatchCharLength:s,findAllMatches:r,ignoreLocation:i,location:o,threshold:a,distance:c},this.pattern=e?t:t.toLowerCase(),this.query=function(t,e={}){return t.split("|").map((t=>{let n=t.trim().split(R).filter((t=>t&&!!t.trim())),s=[];for(let t=0,i=n.length;t<i;t+=1){const i=n[t];let r=!1,o=-1;for(;!r&&++o<T;){const t=A[o];let n=t.isMultiMatch(i);n&&(s.push(new t(n,e)),r=!0)}if(!r)for(o=-1;++o<T;){const t=A[o];let n=t.isSingleMatch(i);if(n){s.push(new t(n,e));break}}}return s}))}(this.pattern,this.options)}static condition(t,e){return e.useExtendedSearch}searchIn(t){const e=this.query;if(!e)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:s}=this.options;t=s?t:t.toLowerCase();let i=0,r=[],o=0;for(let s=0,a=e.length;s<a;s+=1){const a=e[s];r.length=0,i=0;for(let e=0,s=a.length;e<s;e+=1){const s=a[e],{isMatch:c,indices:l,score:h}=s.search(t);if(!c){o=0,i=0,r.length=0;break}if(i+=1,o+=h,n){const t=s.constructor.type;$.has(t)?r=[...r,...l]:r.push(l)}}if(i){let t={isMatch:!0,score:o/i};return n&&(t.indices=r),t}}return{isMatch:!1,score:1}}}const O=[];function F(t,e){for(let n=0,s=O.length;n<s;n+=1){let s=O[n];if(s.condition(t,e))return new s(t,e)}return new S(t,e)}const P="$and",W="$or",j="$path",q="$val",D=t=>!(!t[P]&&!t[W]),B=t=>({[P]:Object.keys(t).map((e=>({[e]:t[e]})))});function H(e,n,{auto:i=!0}={}){const r=e=>{let a=Object.keys(e);const c=(t=>!!t[j])(e);if(!c&&a.length>1&&!D(e))return r(B(e));if((e=>!t(e)&&o(e)&&!D(e))(e)){const t=c?e[j]:a[0],r=c?e[q]:e[t];if(!s(r))throw new Error((t=>`Invalid value for key ${t}`)(t));const o={keyId:p(t),pattern:r};return i&&(o.searcher=F(r,n)),o}let l={children:[],operator:a[0]};return a.forEach((n=>{const s=e[n];t(s)&&s.forEach((t=>{l.children.push(r(t))}))})),l};return D(e)||(e=B(e)),r(e)}function U(t,e){const n=t.matches;e.matches=[],a(n)&&n.forEach((t=>{if(!a(t.indices)||!t.indices.length)return;const{indices:n,value:s}=t;let i={indices:n,value:s};t.key&&(i.key=t.key.src),t.idx>-1&&(i.refIndex=t.idx),e.matches.push(i)}))}function z(t,e){e.score=t.score}class V{constructor(t,e={},n){this.options={...w,...e},this.options.useExtendedSearch,this._keyStore=new g(this.options.keys),this.setCollection(t,n)}setCollection(t,e){if(this._docs=t,e&&!(e instanceof v))throw new Error("Incorrect 'index' type");this._myIndex=e||k(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){a(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const e=[];for(let n=0,s=this._docs.length;n<s;n+=1){const i=this._docs[n];t(i,n)&&(this.removeAt(n),n-=1,s-=1,e.push(i))}return e}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:e=-1}={}){const{includeMatches:n,includeScore:r,shouldSort:o,sortFn:a,ignoreFieldNorm:c}=this.options;let l=s(t)?s(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return function(t,{ignoreFieldNorm:e=w.ignoreFieldNorm}){t.forEach((t=>{let n=1;t.matches.forEach((({key:t,norm:s,score:i})=>{const r=t?t.weight:null;n*=Math.pow(0===i&&r?Number.EPSILON:i,(r||1)*(e?1:s))})),t.score=n}))}(l,{ignoreFieldNorm:c}),o&&l.sort(a),i(e)&&e>-1&&(l=l.slice(0,e)),function(t,e,{includeMatches:n=w.includeMatches,includeScore:s=w.includeScore}={}){const i=[];return n&&i.push(U),s&&i.push(z),t.map((t=>{const{idx:n}=t,s={item:e[n],refIndex:n};return i.length&&i.forEach((e=>{e(t,s)})),s}))}(l,this._docs,{includeMatches:n,includeScore:r})}_searchStringList(t){const e=F(t,this.options),{records:n}=this._myIndex,s=[];return n.forEach((({v:t,i:n,n:i})=>{if(!a(t))return;const{isMatch:r,score:o,indices:c}=e.searchIn(t);r&&s.push({item:t,idx:n,matches:[{score:o,value:t,norm:i,indices:c}]})})),s}_searchLogical(t){const e=H(t,this.options),n=(t,e,s)=>{if(!t.children){const{keyId:n,searcher:i}=t,r=this._findMatches({key:this._keyStore.get(n),value:this._myIndex.getValueForItemAtKeyId(e,n),searcher:i});return r&&r.length?[{idx:s,item:e,matches:r}]:[]}const i=[];for(let r=0,o=t.children.length;r<o;r+=1){const o=t.children[r],a=n(o,e,s);if(a.length)i.push(...a);else if(t.operator===P)return[]}return i},s=this._myIndex.records,i={},r=[];return s.forEach((({$:t,i:s})=>{if(a(t)){let o=n(e,t,s);o.length&&(i[s]||(i[s]={idx:s,item:t,matches:[]},r.push(i[s])),o.forEach((({matches:t})=>{i[s].matches.push(...t)})))}})),r}_searchObjectList(t){const e=F(t,this.options),{keys:n,records:s}=this._myIndex,i=[];return s.forEach((({$:t,i:s})=>{if(!a(t))return;let r=[];n.forEach(((n,s)=>{r.push(...this._findMatches({key:n,value:t[s],searcher:e}))})),r.length&&i.push({idx:s,item:t,matches:r})})),i}_findMatches({key:e,value:n,searcher:s}){if(!a(n))return[];let i=[];if(t(n))n.forEach((({v:t,i:n,n:r})=>{if(!a(t))return;const{isMatch:o,score:c,indices:l}=s.searchIn(t);o&&i.push({score:c,key:e,value:t,idx:n,norm:r,indices:l})}));else{const{v:t,n:r}=n,{isMatch:o,score:a,indices:c}=s.searchIn(t);o&&i.push({score:a,key:e,value:t,norm:r,indices:c})}return i}}V.version="7.0.0",V.createIndex=k,V.parseIndex=function(t,{getFn:e=w.getFn,fieldNormWeight:n=w.fieldNormWeight}={}){const{keys:s,records:i}=t,r=new v({getFn:e,fieldNormWeight:n});return r.setKeys(s),r.setIndexRecords(i),r},V.config=w,V.parseQuery=H,function(...t){O.push(...t)}(N);class K{_val;_watchers=[];constructor(t){this._val=t}get value(){return this._val}set value(t){this._val=t;for(const e of this._watchers)e.fn(t),e.time--;this._watchers=this._watchers.filter((t=>t.time>0))}watch(t,e=1/0){this._watchers.push({fn:t,time:e})}watchOnce(t){this._watchers.push({fn:t,time:1})}async nextVal(){return new Promise((t=>{this.watchOnce((()=>t(this.value)))}))}_checkin(t){for(const e of t){if(null==e&&null==this._val)return!0;if(this._val===e)return!0}return!1}async unitl(...t){for(;!this._checkin(t);)await this.nextVal();return this.value}async unitlNot(...t){for(;this._checkin(t);)await this.nextVal();return this.value}}const G={get base(){return document.getElementById("site_data_static")?.dataset.url??"/"},get root(){return new URL(this.base,window.location.origin)},url_for(t){return"/"===t[0]&&(t=t.slice(1)),this.root+t}};class Y{loaded=new K(!1);__data=null;constructor(t,e=t=>t){("string"==typeof t?fetch(G.url_for(t)).then((t=>t.json())):t).then((t=>{this.loaded.value=!0,this.__data=e(t)}))}async data(){return await this.loaded.unitl(!0),this.__data}}function J(t,e,...n){let[s,...i]=t.split(".");s||(s="div");const r=document.createElement(s);if(r.classList.add(...i),null!=e)for(const[t,n]of Object.entries(e))"class"===t&&e.class?r.classList.add(...e.class.split(" ")):t.startsWith("on")?r.addEventListener(t.slice(2),n):r.setAttribute(t,n);return n.flat().forEach((t=>{!function(t){"string"==typeof t?r.innerHTML+=t:t instanceof Element&&r.appendChild(t)}(t)})),r}function Q(t){return String(t).replace(/[&<>'"]/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"}[t]||t)))}function X(){try{const t=({avatar:t,href:e,title:n,description:s})=>J("div",{class:"friend-link-container"},J("div",{class:"friend-link-box"},J("aside",{class:"friend-link-avatar"},J("img",{src:Q(t),href:Q(e)})),J("div",{class:"friend-link-meta"},J("div",{class:"friend-link-title"},J("a",{href:Q(e)},Q(n))),J("div",{class:"friend-link-description"},Q(s)))));document.querySelectorAll(".friend-link").forEach((e=>{e.replaceWith(t(e.dataset))}))}catch(t){console.error(t)}}function Z(t){setTimeout((()=>{t()}),10)}var tt=Object.freeze({__proto__:null,copyToClipboard:async function(t){try{await window.navigator.clipboard.writeText(t)}catch(e){const n=document.createElement("textarea");n.value=t,n.style.width="0",n.style.position="fixed",n.style.left="-999px",n.style.top="10px",n.setAttribute("readonly","readonly"),document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n)}finally{new Promise((t=>{const e=document.getElementById("success-indicator");e?.classList.add("show"),setTimeout((()=>{e?.classList.add("animated","fadeOut")}),500),setTimeout((()=>{e?.classList.remove("show","animated","fadeOut"),t()}),1e3)}))}},escapeHTML:Q,h:J,make_friends_list:X,nextTick:Z});class et{constructor(){document.addEventListener("DOMContentLoaded",(()=>{this.init()}),{once:!0})}init(){}}const nt=new Map,st=new Y("site.json");st.data().then((t=>{for(const e of["pages","posts","tags","categories"])for(const n of t[e]??[]){const t=n.path?.replaceAll("index.html","")||"";nt.set(t,n)}}));const it={...G,data:()=>st.data(),thisPageUrl(){let t=window.location.pathname;return t.startsWith("/")&&(t=t.slice(1)),"/"!==t.slice(-1)&&(t+="/"),t=decodeURI(t),t},thisPage:async()=>(await it.data(),nt.get(it.thisPageUrl()))};async function rt(t){if(t.url&&(t.script=await fetch(t.url).then((t=>t.text()))),!t.script)return;new Function(t.script)()}const ot=new class{pageChangeFns=[];routerStates=new Map;__animating=new K(!1);__loading=new K(!1);constructor(){window.history.scrollRestoration="manual",window.addEventListener("DOMContentLoaded",(()=>{this.handlePage()})),window.addEventListener("popstate",(t=>this.onPopState(t)),!1),this.makeLink()}isThisSite(t){return!!t&&((t+="/").startsWith(it.root.href)||t.startsWith(it.base))}scrollToHash(t){if(null==t&&(t=window.location.hash),!t)return;const e=decodeURI(t).slice(1),n=document.getElementById(e);n&&window.scrollTo({left:0,top:n.offsetTop+(n.offsetParent?.offsetTop||0)-80,behavior:"smooth"})}set loading(t){this.__loading.value=t,this.__animating.value=!0;const e=document.querySelector(".main.animated");!0===t&&(e?.classList.add("fadeOutDown"),e?.classList.remove("fadeInDown")),!1===t&&(e?.classList.remove("fadeOutDown"),e?.classList.add("fadeInDown")),setTimeout((()=>{this.__animating.value=!1}),250)}get loading(){return this.__loading.value}getRouterState(){return{url:document.location.href,body:document.getElementsByTagName("main-outlet")[0].innerHTML,title:document.title,scrollY:window.scrollY}}cacheRouterState(){this.routerStates.set(document.location.href,this.getRouterState())}updateRouterState(t){const e=this.routerStates.has(t.url);e?Object.assign(e,t):this.routerStates.set(t.url,t)}async queryPageData(t){const e=this.routerStates.get(t);if(e)return e;const n=await fetch(t).then((t=>t.text()));if("string"!=typeof n)throw{reason:"NOT HTML",url:t};const s=n.match(/<main-outlet>([\s\S]*)<\/main-outlet>/)?.[1];if(!s)throw{reason:"NOT HTML",url:t};const i=n.match(/<head>([\s\S]*)<\/head>/)?.[1];let r=i?.match(/<title>([\s\S]*)<\/title>/)?.[1];return r??=document.title,{url:t,body:s,title:r}}async replacePage({body:t,title:e,url:n,scrollY:s},i=!0){const r=document.getElementsByClassName("sidebar")[0].clientHeight-40;this.cacheRouterState(),await this.__animating.unitl(!1),i&&history.pushState({time:new Date,url:n},"",n),document.querySelector("main-outlet").innerHTML=t,document.title=e,this.updateRouterState({url:document.location.href,body:t,title:e}),this.handlePage(),s?window.scrollTo({left:0,top:s}):window.innerWidth>960||window.location.href===it.url_for("/")||window.location.href.slice(0,-1)===it.url_for("/")?window.scrollTo({left:0,top:0,behavior:"smooth"}):window.scrollTo({left:0,top:r})}async routeTo(t,e=!0){if(console.log(`Route to: ${t}`),t)if(this.isThisSite(t)){const n=new URL(t,window.location.origin);if(e&&n.pathname===window.location.pathname)return console.log("scroll to hash"),history.replaceState({time:new Date},document.title,t),void this.scrollToHash(n.hash);try{this.loading=!0,e&&this.cacheRouterState();const n=await this.queryPageData(t);await this.replacePage(n,e),this.loading=!1,this.handlePage()}catch(t){if(404===t.status)return void(window.location.href=t.url);if("NOT HTML"===t?.reason)return void(window.location.href=t.url);console.error(t),alert(t),await this.replacePage(this.getRouterState(),!1)}}else window.location.href=t}makeLink(){document.addEventListener("click",(t=>{let e=t.target;for(;e;){if(e.onclick)return;this.isThisSite(e.href)&&(t.preventDefault(),t.stopPropagation(),this.routeTo(e.href,!0)),e=e.parentNode}}))}handlePage(){this.scrollToHash(),this.reloadScript(),this.pageChangeFns.forEach((t=>{try{t()}catch(t){console.error(t)}}))}onPopState(t){t.preventDefault(),this.routeTo(window.location.href,!1)}onPageChange(t){this.pageChangeFns.push(t)}reloadScript(){const t=document.querySelector("main-outlet")?.getElementsByTagName("script");for(const e of t??[])rt({url:e.src,script:e.textContent})}};ot.onPageChange(X);const at=["posts","pages","tags","categories"];let ct=null;async function lt(t=3){if(!ct)return;const e=(await mt.getPageTitle()).slice(0,50);if(e){if(ct.valine?.enable&&window.Valine&&new window.Valine({el:"#vcomments",notify:ct.valine.notify||!1,verify:ct.valine.verify||!1,app_id:ct.valine.appid,app_key:ct.valine.appkey,placeholder:ct.valine.placeholder,path:window.location.pathname,serverURLs:ct.valine.serverURLs,visitor:!0,recordIP:!0,avatar:ct.valine.avatar}),ct.gitment?.enable&&window.Gitment){var n={id:e,owner:ct.gitment.owner,repo:ct.gitment.repo,oauth:{client_id:ct.gitment.client_id,client_secret:ct.gitment.client_secret}};""!=ct.gitment.id&&(n.id=ct.gitment.id),new window.Gitment(n).render("gitment_container")}if(ct.gitalk?.enable&&window.Gitalk){new window.Gitalk({clientID:ct.gitalk.client_id,clientSecret:ct.gitalk.client_secret,repo:ct.gitalk.repo,owner:ct.gitalk.owner,admin:[ct.gitalk.owner],id:e,distractionFreeMode:!1}).render("gitalk_container")}}}ot.onPageChange((()=>lt().catch((()=>{}))));var ht=Object.freeze({__proto__:null,load:lt,setConfig:function(t){ct=t}});function ut(t){var e=document.createElement("link");e.id="themecss",e.rel="stylesheet",e.type="text/css",e.href=t,document.getElementsByTagName("head")[0].appendChild(e)}function dt(){return document.getElementById("default-theme")?.getAttribute("data")}function gt(){document.getElementById("themecss")&&document.getElementById("themecss")?.remove(),localStorage.themeChanged&&"light"==dt()?ut(G.url_for("css/theme/dark.css")):localStorage.themeChanged&&"dark"==dt()?ut(G.url_for("css/theme/light.css")):ut(G.url_for(`css/theme/${dt()}.css`))}async function ft(){return(await it.thisPage())?.title??document.querySelector("title")?.textContent??""}gt();const mt={comment:ht,site:it,search:new class extends et{searchData;config={};showing=!1;get mainEl(){return document.querySelector(".ins-search")}get inputEl(){return this.mainEl?.querySelector(".ins-search-input")}get wrapperEl(){return this.mainEl?.querySelector(".ins-section-wrapper")}get containerEl(){return this.mainEl?.querySelector(".ins-section-container")}fuses={};fuse_ok=new K(!1);constructor(){super(),this.searchData=new Y("content.json")}init(){this.buildFuse(),document.body.appendChild(this.mainEl),this.inputEl.addEventListener("keydown",(t=>{switch(t.code){case"ArrowDown":this.markActive(this.getSelectedIndex()+1);break;case"ArrowUp":this.markActive(this.getSelectedIndex()-1);break;case"Enter":const t=document.querySelector(".ins-selectable.active")?.dataset.url;t&&this.gotoLink(t);break;case"Escape":this.closeWindow()}})),this.inputEl.addEventListener("input",(()=>{Z((()=>{this.search()}))})),document.addEventListener("keydown",(t=>{const e=document.querySelector(":focus");"TEXTAREA"!==e?.tagName&&"INPUT"!==e?.tagName&&(this.showing||"s"===t.key&&Z((()=>this.openWindow())))})),document.addEventListener("click",(t=>{t.target!==this.inputEl&&this.showing&&this.closeWindow()}))}getSelectedIndex(){let t=-1;return document.querySelectorAll(".ins-selectable").forEach(((e,n)=>{e.classList.contains("active")&&(t=n)})),t}markActive(t){const e=document.querySelectorAll(".ins-selectable");t=(t+Number(-2==t)+e.length)%e.length,e.forEach(((e,n)=>{e.classList.remove("active"),n===t&&e.classList.add("active")}))}gotoLink(t){ot.routeTo(t),this.closeWindow()}makeSearchItem(t,e,n,s,i){return J("div",{class:"ins-selectable ins-search-item","data-url":i,onclick:()=>{this.gotoLink(i)}},J("header",null,J("i",{class:`fa fa-${t}`}),J("span",{class:"ins-title"},null!=e&&""!==e?e:this.config.translation.untitled),n?J("span",{class:"ins-slug"},n):null),s?J("p",{class:"ins-search-preview"},s):null)}makeSection(t,e){const n=this.config.translation[t];let s;return 0===e.length?null:(s=e.map((e=>{const n={};for(const[t,s]of Object.entries(e))n[t]="link"!==t?Q(s):s;const s=("matches"in e?e.matches:null)??[];for(const t of s){if("link"===t.key)continue;if(null==t.key)continue;const[s,i]=t.indices.reduce(((t,e)=>t[1]-t[0]<e[1]-e[0]?e:t),[0,-1]);n[t.key]=Q(e[t.key].slice(0,s))+"<mark>"+Q(e[t.key].slice(s,i+1))+"</mark>"+Q(e[t.key].slice(i+1)),"text"===t.key&&(n.text=n.text.slice(Math.max(s-20,0)))}return["posts","pages"].includes(t)?this.makeSearchItem("file",n.title,null,n.text.slice(0,150),n.link):["categories","tags"].includes(t)?this.makeSearchItem("categories"===t?"folder":"tag",n.name,n.slug,null,n.link):null})),J("section",{class:"ins-section"},J("header",{class:"ins-section-header"},n),s))}async buildFuse(){const t=await this.searchData.data();V.config.ignoreLocation=!0,V.config.includeMatches=!0,this.fuses.posts=new V(t.posts,{keys:["title","text","link"]}),this.fuses.pages=new V(t.pages,{keys:["title","text","link"]}),this.fuses.tags=new V(t.tags,{keys:["name","slug","link"]}),this.fuses.categories=new V(t.categories,{keys:["name","slug","link"]}),this.fuse_ok.value=!0}async getSearchResult(t){await this.fuse_ok.unitl(!0);const e=await this.searchData.data(),n=n=>t?this.fuses[n].search(t,{limit:5}).map((t=>({...t,...t.item}))):e[n].slice(0,5);return at.map((t=>[t,n(t)]))}search(){const t=this.inputEl.value;this.getSearchResult(t).then((t=>{this.containerEl.innerHTML="";for(const[e,n]of t){const t=this.makeSection(e,n);t&&this.containerEl.appendChild(t)}}))}selectItemByDiff(t){const e=this.containerEl.querySelectorAll(".ins-selectable");let n=-1;e.forEach(((t,e)=>{if(t.classList.contains("active"))return t.classList.remove("active"),void(n=e)})),e[(e.length+n+t)%e.length].classList.add("active")}openWindow(){this.mainEl.classList.add("animated","fadeIn","show"),this.mainEl.classList.remove("fadeOut"),this.inputEl.focus(),Z((()=>{this.inputEl.setSelectionRange(0,this.inputEl.value.length),this.showing=!0})),this.search()}closeWindow(){this.showing&&(this.mainEl.classList.add("fadeOut"),this.mainEl.classList.remove("fadeIn"),this.inputEl.blur(),this.showing=!1,setTimeout((()=>{this.mainEl.classList.remove("show")}),400))}},getPageTitle:ft,share:{native:async()=>{window.navigator.share({url:window.location.href,text:await ft(),title:await ft()})}},darkLightToggle:function(){localStorage.themeChanged?localStorage.removeItem("themeChanged"):localStorage.setItem("themeChanged","true"),gt()}};window.Anatolo=mt,window.Utils=tt,new class extends et{init(){document.addEventListener("scroll",(()=>{window.scrollY<200?document.querySelector("#scroll-to-top.float-button")?.classList.add("hide"):document.querySelector("#scroll-to-top.float-button")?.classList.remove("hide")}))}}}));
