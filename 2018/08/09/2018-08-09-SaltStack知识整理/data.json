{"title":"SaltStack知识整理","date":"2018-08-09T02:47:03.000Z","source":"_posts/2018-08-09.SaltStack知识整理.md","raw":"---\ntitle: SaltStack知识整理\ndate: 2018-08-09 10:47:03\ntags: [运维,saltStack,django]\n---\n\n>上一篇说到了salt的简单安装，接下来将对学习salt相关模块进行整理和学习\n\n# Grains\n\nGrains是存储minion基本信息的，里面存放了\bminion端各种系统级参数，采用静态采集方式，在minion启动时进行数据采集。可以通过\n`salt '*' saltutil.sync_grains` 从新进行\bminion端静态信息的采集.\n\n展示minion的Grains静态信息 `salt '*' grains.items`\n\n```shell\n\nnewdev:\n    ----------\n    SSDs:\n        - sda\n        - dm-0\n        - dm-1\n        - dm-2\n    biosreleasedate:\n        05/21/2018\n    biosversion:\n        13.3.1 (43365)\n    cpu_flags:\n        - fpu\n        - vme\n        - de\n        - pse\n        - tsc\n        - msr\n        - pae\n        - mce\n        - cx8\n        - apic\n        - sep\n        - mtrr\n        - pge\n        - mca\n        - cmov\n        - pat\n        - pse36\n        - clflush\n        - mmx\n        - fxsr\n        - sse\n        - sse2\n        - ss\n        - ht\n        - syscall\n        - nx\n        - rdtscp\n        - lm\n        - constant_tsc\n        - nopl\n        - xtopology\n        - nonstop_tsc\n        - eagerfpu\n        - pni\n        - pclmulqdq\n        - ssse3\n        - fma\n        - cx16\n        - pcid\n        - sse4_1\n        - sse4_2\n        - x2apic\n        - movbe\n        - popcnt\n        - tsc_deadline_timer\n        - aes\n        - xsave\n        - avx\n        - f16c\n        - rdrand\n        - hypervisor\n        - lahf_lm\n        - abm\n        - 3dnowprefetch\n        - fsgsbase\n        - tsc_adjust\n        - bmi1\n        - hle\n        - avx2\n        - smep\n        - bmi2\n        - invpcid\n        - mpx\n        - adx\n        - clflushopt\n        - xsaveopt\n        - dtherm\n        - arat\n        - pln\n        - pts\n    cpu_model:\n        Intel(R) Core(TM) i5-7360U CPU @ 2.30GHz\n    cpuarch:\n        x86_64\n    disks:\n        - sr0\n    dns:\n        ----------\n        domain:\n        ip4_nameservers:\n            - 192.168.1.1\n        ip6_nameservers:\n        nameservers:\n            - 192.168.1.1\n        options:\n        search:\n            - lan\n        sortlist:\n    domain:\n    fqdn:\n        salt_salve_2\n    fqdn_ip4:\n        - 192.168.1.145\n    fqdn_ip6:\n        - fe80::d0f:e7bc:6a7f:a752\n    gid:\n        0\n    gpus:\n        |_\n          ----------\n          model:\n              Accelerated Virtual Video Adapter\n          vendor:\n              unknown\n    groupname:\n        root\n    host:\n        salt_salve_2\n    hwaddr_interfaces:\n        ----------\n        eth0:\n            00:1c:42:bb:de:e6\n        lo:\n            00:00:00:00:00:00\n    id:\n        newdev\n    init:\n        systemd\n    ip4_gw:\n        192.168.1.1\n    ip4_interfaces:\n        ----------\n        eth0:\n            - 192.168.1.145\n        lo:\n            - 127.0.0.1\n    ip6_gw:\n        False\n    ip6_interfaces:\n        ----------\n        eth0:\n            - fe80::d0f:e7bc:6a7f:a752\n        lo:\n            - ::1\n    ip_gw:\n        True\n    ip_interfaces:\n        ----------\n        eth0:\n            - 192.168.1.145\n            - fe80::d0f:e7bc:6a7f:a752\n        lo:\n            - 127.0.0.1\n            - ::1\n    ipv4:\n        - 127.0.0.1\n        - 192.168.1.145\n    ipv6:\n        - ::1\n        - fe80::d0f:e7bc:6a7f:a752\n    kernel:\n        Linux\n    kernelrelease:\n        3.10.0-862.el7.x86_64\n    kernelversion:\n        #1 SMP Fri Apr 20 16:44:24 UTC 2018\n    locale_info:\n        ----------\n        defaultencoding:\n            UTF-8\n        defaultlanguage:\n            en_US\n        detectedencoding:\n            UTF-8\n    localhost:\n        salt_salve_2\n    lsb_distrib_codename:\n        CentOS Linux 7 (Core)\n    lsb_distrib_id:\n        CentOS Linux\n    machine_id:\n        4759594b77c0c04fb629ee0b4da6fdbe\n    manufacturer:\n        Parallels Software International Inc.\n    master:\n        192.168.1.194\n    mdadm:\n    mem_total:\n        1222\n    nodename:\n        localhost.localdomain\n    num_cpus:\n        2\n    num_gpus:\n        1\n    os:\n        CentOS\n    os_family:\n        RedHat\n    osarch:\n        x86_64\n    oscodename:\n        CentOS Linux 7 (Core)\n    osfinger:\n        CentOS Linux-7\n    osfullname:\n        CentOS Linux\n    osmajorrelease:\n        7\n    osrelease:\n        7.5.1804\n    osrelease_info:\n        - 7\n        - 5\n        - 1804\n    path:\n        /usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin\n    pid:\n        24821\n    productname:\n        Parallels Virtual Platform\n    ps:\n        ps -efHww\n    pythonexecutable:\n        /usr/bin/python\n    pythonpath:\n        - /usr/bin\n        - /usr/lib64/python27.zip\n        - /usr/lib64/python2.7\n        - /usr/lib64/python2.7/plat-linux2\n        - /usr/lib64/python2.7/lib-tk\n        - /usr/lib64/python2.7/lib-old\n        - /usr/lib64/python2.7/lib-dynload\n        - /usr/lib64/python2.7/site-packages\n        - /usr/lib/python2.7/site-packages\n    pythonversion:\n        - 2\n        - 7\n        - 5\n        - final\n        - 0\n    saltpath:\n        /usr/lib/python2.7/site-packages/salt\n    saltversion:\n        2018.3.2\n    saltversioninfo:\n        - 2018\n        - 3\n        - 2\n        - 0\n    selinux:\n        ----------\n        enabled:\n            True\n        enforced:\n            Enforcing\n    serialnumber:\n        Parallels-4B 59 59 47 C0 77 4F C0 B6 29 EE 0B 4D A6 FD BE\n    server_id:\n        2082849409\n    shell:\n        /bin/bash\n    swap_total:\n        2047\n    systemd:\n        ----------\n        features:\n            +PAM +AUDIT +SELINUX +IMA -APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ +LZ4 -SECCOMP +BLKID +ELFUTILS +KMOD +IDN\n        version:\n            219\n    uid:\n        0\n    username:\n        root\n    uuid:\n        4759594b-77c0-c04f-b629-ee0b4da6fdbe\n    virtual:\n        Parallels\n    zfs_feature_flags:\n        False\n    zfs_support:\n        False\n    zmqversion:\n        4.1.4\n```\n\n\b# Pillar\n\nPillar主要用于master端分发给minion端的信息，针对于Grains不同的是它是`动态加密`传输的，而且只有指定minion才能收到这些pillar信息。\n\n通过`salt '*' pillar.items` \b来展示pillar信息，通过`salt '*' saltutil.refresh_pillar` 来刷新pillar信息。\n\n```shell\n\nnewdev:\n    ----------\n    groups:\n        |_\n          ----------\n          name:\n              dev\n          nodes:\n              - dev\n              - newdev\n    sshd_port:\n        22\n```\n\n# High State 与 Low State\n\n如果什么配置都没问题以后可以通过 `salt '*' state.highstate` 完成所有机器的部署动作。\n\n\n","slug":"2018-08-09-SaltStack知识整理","published":true,"updated":"2024-09-02T09:06:11.429Z","_id":"cm0q19pfg0021w8snfgmhft20","comments":true,"layout":"post","photos":[],"html":"<blockquote>\n<p>上一篇说到了salt的简单安装，接下来将对学习salt相关模块进行整理和学习</p>\n</blockquote>\n<h1 id=\"Grains\"><a href=\"#Grains\" class=\"headerlink\" title=\"Grains\"></a>Grains</h1><p>Grains是存储minion基本信息的，里面存放了\bminion端各种系统级参数，采用静态采集方式，在minion启动时进行数据采集。可以通过<br><code>salt &#39;*&#39; saltutil.sync_grains</code> 从新进行\bminion端静态信息的采集.</p>\n<p>展示minion的Grains静态信息 <code>salt &#39;*&#39; grains.items</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">newdev:</span><br><span class=\"line\">    ----------</span><br><span class=\"line\">    SSDs:</span><br><span class=\"line\">        - sda</span><br><span class=\"line\">        - dm-0</span><br><span class=\"line\">        - dm-1</span><br><span class=\"line\">        - dm-2</span><br><span class=\"line\">    biosreleasedate:</span><br><span class=\"line\">        05/21/2018</span><br><span class=\"line\">    biosversion:</span><br><span class=\"line\">        13.3.1 (43365)</span><br><span class=\"line\">    cpu_flags:</span><br><span class=\"line\">        - fpu</span><br><span class=\"line\">        - vme</span><br><span class=\"line\">        - de</span><br><span class=\"line\">        - pse</span><br><span class=\"line\">        - tsc</span><br><span class=\"line\">        - msr</span><br><span class=\"line\">        - pae</span><br><span class=\"line\">        - mce</span><br><span class=\"line\">        - cx8</span><br><span class=\"line\">        - apic</span><br><span class=\"line\">        - sep</span><br><span class=\"line\">        - mtrr</span><br><span class=\"line\">        - pge</span><br><span class=\"line\">        - mca</span><br><span class=\"line\">        - cmov</span><br><span class=\"line\">        - pat</span><br><span class=\"line\">        - pse36</span><br><span class=\"line\">        - clflush</span><br><span class=\"line\">        - mmx</span><br><span class=\"line\">        - fxsr</span><br><span class=\"line\">        - sse</span><br><span class=\"line\">        - sse2</span><br><span class=\"line\">        - ss</span><br><span class=\"line\">        - ht</span><br><span class=\"line\">        - syscall</span><br><span class=\"line\">        - nx</span><br><span class=\"line\">        - rdtscp</span><br><span class=\"line\">        - lm</span><br><span class=\"line\">        - constant_tsc</span><br><span class=\"line\">        - nopl</span><br><span class=\"line\">        - xtopology</span><br><span class=\"line\">        - nonstop_tsc</span><br><span class=\"line\">        - eagerfpu</span><br><span class=\"line\">        - pni</span><br><span class=\"line\">        - pclmulqdq</span><br><span class=\"line\">        - ssse3</span><br><span class=\"line\">        - fma</span><br><span class=\"line\">        - cx16</span><br><span class=\"line\">        - pcid</span><br><span class=\"line\">        - sse4_1</span><br><span class=\"line\">        - sse4_2</span><br><span class=\"line\">        - x2apic</span><br><span class=\"line\">        - movbe</span><br><span class=\"line\">        - popcnt</span><br><span class=\"line\">        - tsc_deadline_timer</span><br><span class=\"line\">        - aes</span><br><span class=\"line\">        - xsave</span><br><span class=\"line\">        - avx</span><br><span class=\"line\">        - f16c</span><br><span class=\"line\">        - rdrand</span><br><span class=\"line\">        - hypervisor</span><br><span class=\"line\">        - lahf_lm</span><br><span class=\"line\">        - abm</span><br><span class=\"line\">        - 3dnowprefetch</span><br><span class=\"line\">        - fsgsbase</span><br><span class=\"line\">        - tsc_adjust</span><br><span class=\"line\">        - bmi1</span><br><span class=\"line\">        - hle</span><br><span class=\"line\">        - avx2</span><br><span class=\"line\">        - smep</span><br><span class=\"line\">        - bmi2</span><br><span class=\"line\">        - invpcid</span><br><span class=\"line\">        - mpx</span><br><span class=\"line\">        - adx</span><br><span class=\"line\">        - clflushopt</span><br><span class=\"line\">        - xsaveopt</span><br><span class=\"line\">        - dtherm</span><br><span class=\"line\">        - arat</span><br><span class=\"line\">        - pln</span><br><span class=\"line\">        - pts</span><br><span class=\"line\">    cpu_model:</span><br><span class=\"line\">        Intel(R) Core(TM) i5-7360U CPU @ 2.30GHz</span><br><span class=\"line\">    cpuarch:</span><br><span class=\"line\">        x86_64</span><br><span class=\"line\">    disks:</span><br><span class=\"line\">        - sr0</span><br><span class=\"line\">    dns:</span><br><span class=\"line\">        ----------</span><br><span class=\"line\">        domain:</span><br><span class=\"line\">        ip4_nameservers:</span><br><span class=\"line\">            - 192.168.1.1</span><br><span class=\"line\">        ip6_nameservers:</span><br><span class=\"line\">        nameservers:</span><br><span class=\"line\">            - 192.168.1.1</span><br><span class=\"line\">        options:</span><br><span class=\"line\">        search:</span><br><span class=\"line\">            - lan</span><br><span class=\"line\">        sortlist:</span><br><span class=\"line\">    domain:</span><br><span class=\"line\">    fqdn:</span><br><span class=\"line\">        salt_salve_2</span><br><span class=\"line\">    fqdn_ip4:</span><br><span class=\"line\">        - 192.168.1.145</span><br><span class=\"line\">    fqdn_ip6:</span><br><span class=\"line\">        - fe80::d0f:e7bc:6a7f:a752</span><br><span class=\"line\">    gid:</span><br><span class=\"line\">        0</span><br><span class=\"line\">    gpus:</span><br><span class=\"line\">        |_</span><br><span class=\"line\">          ----------</span><br><span class=\"line\">          model:</span><br><span class=\"line\">              Accelerated Virtual Video Adapter</span><br><span class=\"line\">          vendor:</span><br><span class=\"line\">              unknown</span><br><span class=\"line\">    groupname:</span><br><span class=\"line\">        root</span><br><span class=\"line\">    host:</span><br><span class=\"line\">        salt_salve_2</span><br><span class=\"line\">    hwaddr_interfaces:</span><br><span class=\"line\">        ----------</span><br><span class=\"line\">        eth0:</span><br><span class=\"line\">            00:1c:42:bb:de:e6</span><br><span class=\"line\">        lo:</span><br><span class=\"line\">            00:00:00:00:00:00</span><br><span class=\"line\">    id:</span><br><span class=\"line\">        newdev</span><br><span class=\"line\">    init:</span><br><span class=\"line\">        systemd</span><br><span class=\"line\">    ip4_gw:</span><br><span class=\"line\">        192.168.1.1</span><br><span class=\"line\">    ip4_interfaces:</span><br><span class=\"line\">        ----------</span><br><span class=\"line\">        eth0:</span><br><span class=\"line\">            - 192.168.1.145</span><br><span class=\"line\">        lo:</span><br><span class=\"line\">            - 127.0.0.1</span><br><span class=\"line\">    ip6_gw:</span><br><span class=\"line\">        False</span><br><span class=\"line\">    ip6_interfaces:</span><br><span class=\"line\">        ----------</span><br><span class=\"line\">        eth0:</span><br><span class=\"line\">            - fe80::d0f:e7bc:6a7f:a752</span><br><span class=\"line\">        lo:</span><br><span class=\"line\">            - ::1</span><br><span class=\"line\">    ip_gw:</span><br><span class=\"line\">        True</span><br><span class=\"line\">    ip_interfaces:</span><br><span class=\"line\">        ----------</span><br><span class=\"line\">        eth0:</span><br><span class=\"line\">            - 192.168.1.145</span><br><span class=\"line\">            - fe80::d0f:e7bc:6a7f:a752</span><br><span class=\"line\">        lo:</span><br><span class=\"line\">            - 127.0.0.1</span><br><span class=\"line\">            - ::1</span><br><span class=\"line\">    ipv4:</span><br><span class=\"line\">        - 127.0.0.1</span><br><span class=\"line\">        - 192.168.1.145</span><br><span class=\"line\">    ipv6:</span><br><span class=\"line\">        - ::1</span><br><span class=\"line\">        - fe80::d0f:e7bc:6a7f:a752</span><br><span class=\"line\">    kernel:</span><br><span class=\"line\">        Linux</span><br><span class=\"line\">    kernelrelease:</span><br><span class=\"line\">        3.10.0-862.el7.x86_64</span><br><span class=\"line\">    kernelversion:</span><br><span class=\"line\">        #1 SMP Fri Apr 20 16:44:24 UTC 2018</span><br><span class=\"line\">    locale_info:</span><br><span class=\"line\">        ----------</span><br><span class=\"line\">        defaultencoding:</span><br><span class=\"line\">            UTF-8</span><br><span class=\"line\">        defaultlanguage:</span><br><span class=\"line\">            en_US</span><br><span class=\"line\">        detectedencoding:</span><br><span class=\"line\">            UTF-8</span><br><span class=\"line\">    localhost:</span><br><span class=\"line\">        salt_salve_2</span><br><span class=\"line\">    lsb_distrib_codename:</span><br><span class=\"line\">        CentOS Linux 7 (Core)</span><br><span class=\"line\">    lsb_distrib_id:</span><br><span class=\"line\">        CentOS Linux</span><br><span class=\"line\">    machine_id:</span><br><span class=\"line\">        4759594b77c0c04fb629ee0b4da6fdbe</span><br><span class=\"line\">    manufacturer:</span><br><span class=\"line\">        Parallels Software International Inc.</span><br><span class=\"line\">    master:</span><br><span class=\"line\">        192.168.1.194</span><br><span class=\"line\">    mdadm:</span><br><span class=\"line\">    mem_total:</span><br><span class=\"line\">        1222</span><br><span class=\"line\">    nodename:</span><br><span class=\"line\">        localhost.localdomain</span><br><span class=\"line\">    num_cpus:</span><br><span class=\"line\">        2</span><br><span class=\"line\">    num_gpus:</span><br><span class=\"line\">        1</span><br><span class=\"line\">    os:</span><br><span class=\"line\">        CentOS</span><br><span class=\"line\">    os_family:</span><br><span class=\"line\">        RedHat</span><br><span class=\"line\">    osarch:</span><br><span class=\"line\">        x86_64</span><br><span class=\"line\">    oscodename:</span><br><span class=\"line\">        CentOS Linux 7 (Core)</span><br><span class=\"line\">    osfinger:</span><br><span class=\"line\">        CentOS Linux-7</span><br><span class=\"line\">    osfullname:</span><br><span class=\"line\">        CentOS Linux</span><br><span class=\"line\">    osmajorrelease:</span><br><span class=\"line\">        7</span><br><span class=\"line\">    osrelease:</span><br><span class=\"line\">        7.5.1804</span><br><span class=\"line\">    osrelease_info:</span><br><span class=\"line\">        - 7</span><br><span class=\"line\">        - 5</span><br><span class=\"line\">        - 1804</span><br><span class=\"line\">    path:</span><br><span class=\"line\">        /usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin</span><br><span class=\"line\">    pid:</span><br><span class=\"line\">        24821</span><br><span class=\"line\">    productname:</span><br><span class=\"line\">        Parallels Virtual Platform</span><br><span class=\"line\">    ps:</span><br><span class=\"line\">        ps -efHww</span><br><span class=\"line\">    pythonexecutable:</span><br><span class=\"line\">        /usr/bin/python</span><br><span class=\"line\">    pythonpath:</span><br><span class=\"line\">        - /usr/bin</span><br><span class=\"line\">        - /usr/lib64/python27.zip</span><br><span class=\"line\">        - /usr/lib64/python2.7</span><br><span class=\"line\">        - /usr/lib64/python2.7/plat-linux2</span><br><span class=\"line\">        - /usr/lib64/python2.7/lib-tk</span><br><span class=\"line\">        - /usr/lib64/python2.7/lib-old</span><br><span class=\"line\">        - /usr/lib64/python2.7/lib-dynload</span><br><span class=\"line\">        - /usr/lib64/python2.7/site-packages</span><br><span class=\"line\">        - /usr/lib/python2.7/site-packages</span><br><span class=\"line\">    pythonversion:</span><br><span class=\"line\">        - 2</span><br><span class=\"line\">        - 7</span><br><span class=\"line\">        - 5</span><br><span class=\"line\">        - final</span><br><span class=\"line\">        - 0</span><br><span class=\"line\">    saltpath:</span><br><span class=\"line\">        /usr/lib/python2.7/site-packages/salt</span><br><span class=\"line\">    saltversion:</span><br><span class=\"line\">        2018.3.2</span><br><span class=\"line\">    saltversioninfo:</span><br><span class=\"line\">        - 2018</span><br><span class=\"line\">        - 3</span><br><span class=\"line\">        - 2</span><br><span class=\"line\">        - 0</span><br><span class=\"line\">    selinux:</span><br><span class=\"line\">        ----------</span><br><span class=\"line\">        enabled:</span><br><span class=\"line\">            True</span><br><span class=\"line\">        enforced:</span><br><span class=\"line\">            Enforcing</span><br><span class=\"line\">    serialnumber:</span><br><span class=\"line\">        Parallels-4B 59 59 47 C0 77 4F C0 B6 29 EE 0B 4D A6 FD BE</span><br><span class=\"line\">    server_id:</span><br><span class=\"line\">        2082849409</span><br><span class=\"line\">    shell:</span><br><span class=\"line\">        /bin/bash</span><br><span class=\"line\">    swap_total:</span><br><span class=\"line\">        2047</span><br><span class=\"line\">    systemd:</span><br><span class=\"line\">        ----------</span><br><span class=\"line\">        features:</span><br><span class=\"line\">            +PAM +AUDIT +SELINUX +IMA -APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ +LZ4 -SECCOMP +BLKID +ELFUTILS +KMOD +IDN</span><br><span class=\"line\">        version:</span><br><span class=\"line\">            219</span><br><span class=\"line\">    uid:</span><br><span class=\"line\">        0</span><br><span class=\"line\">    username:</span><br><span class=\"line\">        root</span><br><span class=\"line\">    uuid:</span><br><span class=\"line\">        4759594b-77c0-c04f-b629-ee0b4da6fdbe</span><br><span class=\"line\">    virtual:</span><br><span class=\"line\">        Parallels</span><br><span class=\"line\">    zfs_feature_flags:</span><br><span class=\"line\">        False</span><br><span class=\"line\">    zfs_support:</span><br><span class=\"line\">        False</span><br><span class=\"line\">    zmqversion:</span><br><span class=\"line\">        4.1.4</span><br></pre></td></tr></table></figure>\n\n<p>\b# Pillar</p>\n<p>Pillar主要用于master端分发给minion端的信息，针对于Grains不同的是它是<code>动态加密</code>传输的，而且只有指定minion才能收到这些pillar信息。</p>\n<p>通过<code>salt &#39;*&#39; pillar.items</code> \b来展示pillar信息，通过<code>salt &#39;*&#39; saltutil.refresh_pillar</code> 来刷新pillar信息。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">newdev:</span><br><span class=\"line\">    ----------</span><br><span class=\"line\">    groups:</span><br><span class=\"line\">        |_</span><br><span class=\"line\">          ----------</span><br><span class=\"line\">          name:</span><br><span class=\"line\">              dev</span><br><span class=\"line\">          nodes:</span><br><span class=\"line\">              - dev</span><br><span class=\"line\">              - newdev</span><br><span class=\"line\">    sshd_port:</span><br><span class=\"line\">        22</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"High-State-与-Low-State\"><a href=\"#High-State-与-Low-State\" class=\"headerlink\" title=\"High State 与 Low State\"></a>High State 与 Low State</h1><p>如果什么配置都没问题以后可以通过 <code>salt &#39;*&#39; state.highstate</code> 完成所有机器的部署动作。</p>\n","excerpt":"","more":"<blockquote>\n<p>上一篇说到了salt的简单安装，接下来将对学习salt相关模块进行整理和学习</p>\n</blockquote>\n<h1 id=\"Grains\"><a href=\"#Grains\" class=\"headerlink\" title=\"Grains\"></a>Grains</h1><p>Grains是存储minion基本信息的，里面存放了\bminion端各种系统级参数，采用静态采集方式，在minion启动时进行数据采集。可以通过<br><code>salt &#39;*&#39; saltutil.sync_grains</code> 从新进行\bminion端静态信息的采集.</p>\n<p>展示minion的Grains静态信息 <code>salt &#39;*&#39; grains.items</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">newdev:</span><br><span class=\"line\">    ----------</span><br><span class=\"line\">    SSDs:</span><br><span class=\"line\">        - sda</span><br><span class=\"line\">        - dm-0</span><br><span class=\"line\">        - dm-1</span><br><span class=\"line\">        - dm-2</span><br><span class=\"line\">    biosreleasedate:</span><br><span class=\"line\">        05/21/2018</span><br><span class=\"line\">    biosversion:</span><br><span class=\"line\">        13.3.1 (43365)</span><br><span class=\"line\">    cpu_flags:</span><br><span class=\"line\">        - fpu</span><br><span class=\"line\">        - vme</span><br><span class=\"line\">        - de</span><br><span class=\"line\">        - pse</span><br><span class=\"line\">        - tsc</span><br><span class=\"line\">        - msr</span><br><span class=\"line\">        - pae</span><br><span class=\"line\">        - mce</span><br><span class=\"line\">        - cx8</span><br><span class=\"line\">        - apic</span><br><span class=\"line\">        - sep</span><br><span class=\"line\">        - mtrr</span><br><span class=\"line\">        - pge</span><br><span class=\"line\">        - mca</span><br><span class=\"line\">        - cmov</span><br><span class=\"line\">        - pat</span><br><span class=\"line\">        - pse36</span><br><span class=\"line\">        - clflush</span><br><span class=\"line\">        - mmx</span><br><span class=\"line\">        - fxsr</span><br><span class=\"line\">        - sse</span><br><span class=\"line\">        - sse2</span><br><span class=\"line\">        - ss</span><br><span class=\"line\">        - ht</span><br><span class=\"line\">        - syscall</span><br><span class=\"line\">        - nx</span><br><span class=\"line\">        - rdtscp</span><br><span class=\"line\">        - lm</span><br><span class=\"line\">        - constant_tsc</span><br><span class=\"line\">        - nopl</span><br><span class=\"line\">        - xtopology</span><br><span class=\"line\">        - nonstop_tsc</span><br><span class=\"line\">        - eagerfpu</span><br><span class=\"line\">        - pni</span><br><span class=\"line\">        - pclmulqdq</span><br><span class=\"line\">        - ssse3</span><br><span class=\"line\">        - fma</span><br><span class=\"line\">        - cx16</span><br><span class=\"line\">        - pcid</span><br><span class=\"line\">        - sse4_1</span><br><span class=\"line\">        - sse4_2</span><br><span class=\"line\">        - x2apic</span><br><span class=\"line\">        - movbe</span><br><span class=\"line\">        - popcnt</span><br><span class=\"line\">        - tsc_deadline_timer</span><br><span class=\"line\">        - aes</span><br><span class=\"line\">        - xsave</span><br><span class=\"line\">        - avx</span><br><span class=\"line\">        - f16c</span><br><span class=\"line\">        - rdrand</span><br><span class=\"line\">        - hypervisor</span><br><span class=\"line\">        - lahf_lm</span><br><span class=\"line\">        - abm</span><br><span class=\"line\">        - 3dnowprefetch</span><br><span class=\"line\">        - fsgsbase</span><br><span class=\"line\">        - tsc_adjust</span><br><span class=\"line\">        - bmi1</span><br><span class=\"line\">        - hle</span><br><span class=\"line\">        - avx2</span><br><span class=\"line\">        - smep</span><br><span class=\"line\">        - bmi2</span><br><span class=\"line\">        - invpcid</span><br><span class=\"line\">        - mpx</span><br><span class=\"line\">        - adx</span><br><span class=\"line\">        - clflushopt</span><br><span class=\"line\">        - xsaveopt</span><br><span class=\"line\">        - dtherm</span><br><span class=\"line\">        - arat</span><br><span class=\"line\">        - pln</span><br><span class=\"line\">        - pts</span><br><span class=\"line\">    cpu_model:</span><br><span class=\"line\">        Intel(R) Core(TM) i5-7360U CPU @ 2.30GHz</span><br><span class=\"line\">    cpuarch:</span><br><span class=\"line\">        x86_64</span><br><span class=\"line\">    disks:</span><br><span class=\"line\">        - sr0</span><br><span class=\"line\">    dns:</span><br><span class=\"line\">        ----------</span><br><span class=\"line\">        domain:</span><br><span class=\"line\">        ip4_nameservers:</span><br><span class=\"line\">            - 192.168.1.1</span><br><span class=\"line\">        ip6_nameservers:</span><br><span class=\"line\">        nameservers:</span><br><span class=\"line\">            - 192.168.1.1</span><br><span class=\"line\">        options:</span><br><span class=\"line\">        search:</span><br><span class=\"line\">            - lan</span><br><span class=\"line\">        sortlist:</span><br><span class=\"line\">    domain:</span><br><span class=\"line\">    fqdn:</span><br><span class=\"line\">        salt_salve_2</span><br><span class=\"line\">    fqdn_ip4:</span><br><span class=\"line\">        - 192.168.1.145</span><br><span class=\"line\">    fqdn_ip6:</span><br><span class=\"line\">        - fe80::d0f:e7bc:6a7f:a752</span><br><span class=\"line\">    gid:</span><br><span class=\"line\">        0</span><br><span class=\"line\">    gpus:</span><br><span class=\"line\">        |_</span><br><span class=\"line\">          ----------</span><br><span class=\"line\">          model:</span><br><span class=\"line\">              Accelerated Virtual Video Adapter</span><br><span class=\"line\">          vendor:</span><br><span class=\"line\">              unknown</span><br><span class=\"line\">    groupname:</span><br><span class=\"line\">        root</span><br><span class=\"line\">    host:</span><br><span class=\"line\">        salt_salve_2</span><br><span class=\"line\">    hwaddr_interfaces:</span><br><span class=\"line\">        ----------</span><br><span class=\"line\">        eth0:</span><br><span class=\"line\">            00:1c:42:bb:de:e6</span><br><span class=\"line\">        lo:</span><br><span class=\"line\">            00:00:00:00:00:00</span><br><span class=\"line\">    id:</span><br><span class=\"line\">        newdev</span><br><span class=\"line\">    init:</span><br><span class=\"line\">        systemd</span><br><span class=\"line\">    ip4_gw:</span><br><span class=\"line\">        192.168.1.1</span><br><span class=\"line\">    ip4_interfaces:</span><br><span class=\"line\">        ----------</span><br><span class=\"line\">        eth0:</span><br><span class=\"line\">            - 192.168.1.145</span><br><span class=\"line\">        lo:</span><br><span class=\"line\">            - 127.0.0.1</span><br><span class=\"line\">    ip6_gw:</span><br><span class=\"line\">        False</span><br><span class=\"line\">    ip6_interfaces:</span><br><span class=\"line\">        ----------</span><br><span class=\"line\">        eth0:</span><br><span class=\"line\">            - fe80::d0f:e7bc:6a7f:a752</span><br><span class=\"line\">        lo:</span><br><span class=\"line\">            - ::1</span><br><span class=\"line\">    ip_gw:</span><br><span class=\"line\">        True</span><br><span class=\"line\">    ip_interfaces:</span><br><span class=\"line\">        ----------</span><br><span class=\"line\">        eth0:</span><br><span class=\"line\">            - 192.168.1.145</span><br><span class=\"line\">            - fe80::d0f:e7bc:6a7f:a752</span><br><span class=\"line\">        lo:</span><br><span class=\"line\">            - 127.0.0.1</span><br><span class=\"line\">            - ::1</span><br><span class=\"line\">    ipv4:</span><br><span class=\"line\">        - 127.0.0.1</span><br><span class=\"line\">        - 192.168.1.145</span><br><span class=\"line\">    ipv6:</span><br><span class=\"line\">        - ::1</span><br><span class=\"line\">        - fe80::d0f:e7bc:6a7f:a752</span><br><span class=\"line\">    kernel:</span><br><span class=\"line\">        Linux</span><br><span class=\"line\">    kernelrelease:</span><br><span class=\"line\">        3.10.0-862.el7.x86_64</span><br><span class=\"line\">    kernelversion:</span><br><span class=\"line\">        #1 SMP Fri Apr 20 16:44:24 UTC 2018</span><br><span class=\"line\">    locale_info:</span><br><span class=\"line\">        ----------</span><br><span class=\"line\">        defaultencoding:</span><br><span class=\"line\">            UTF-8</span><br><span class=\"line\">        defaultlanguage:</span><br><span class=\"line\">            en_US</span><br><span class=\"line\">        detectedencoding:</span><br><span class=\"line\">            UTF-8</span><br><span class=\"line\">    localhost:</span><br><span class=\"line\">        salt_salve_2</span><br><span class=\"line\">    lsb_distrib_codename:</span><br><span class=\"line\">        CentOS Linux 7 (Core)</span><br><span class=\"line\">    lsb_distrib_id:</span><br><span class=\"line\">        CentOS Linux</span><br><span class=\"line\">    machine_id:</span><br><span class=\"line\">        4759594b77c0c04fb629ee0b4da6fdbe</span><br><span class=\"line\">    manufacturer:</span><br><span class=\"line\">        Parallels Software International Inc.</span><br><span class=\"line\">    master:</span><br><span class=\"line\">        192.168.1.194</span><br><span class=\"line\">    mdadm:</span><br><span class=\"line\">    mem_total:</span><br><span class=\"line\">        1222</span><br><span class=\"line\">    nodename:</span><br><span class=\"line\">        localhost.localdomain</span><br><span class=\"line\">    num_cpus:</span><br><span class=\"line\">        2</span><br><span class=\"line\">    num_gpus:</span><br><span class=\"line\">        1</span><br><span class=\"line\">    os:</span><br><span class=\"line\">        CentOS</span><br><span class=\"line\">    os_family:</span><br><span class=\"line\">        RedHat</span><br><span class=\"line\">    osarch:</span><br><span class=\"line\">        x86_64</span><br><span class=\"line\">    oscodename:</span><br><span class=\"line\">        CentOS Linux 7 (Core)</span><br><span class=\"line\">    osfinger:</span><br><span class=\"line\">        CentOS Linux-7</span><br><span class=\"line\">    osfullname:</span><br><span class=\"line\">        CentOS Linux</span><br><span class=\"line\">    osmajorrelease:</span><br><span class=\"line\">        7</span><br><span class=\"line\">    osrelease:</span><br><span class=\"line\">        7.5.1804</span><br><span class=\"line\">    osrelease_info:</span><br><span class=\"line\">        - 7</span><br><span class=\"line\">        - 5</span><br><span class=\"line\">        - 1804</span><br><span class=\"line\">    path:</span><br><span class=\"line\">        /usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin</span><br><span class=\"line\">    pid:</span><br><span class=\"line\">        24821</span><br><span class=\"line\">    productname:</span><br><span class=\"line\">        Parallels Virtual Platform</span><br><span class=\"line\">    ps:</span><br><span class=\"line\">        ps -efHww</span><br><span class=\"line\">    pythonexecutable:</span><br><span class=\"line\">        /usr/bin/python</span><br><span class=\"line\">    pythonpath:</span><br><span class=\"line\">        - /usr/bin</span><br><span class=\"line\">        - /usr/lib64/python27.zip</span><br><span class=\"line\">        - /usr/lib64/python2.7</span><br><span class=\"line\">        - /usr/lib64/python2.7/plat-linux2</span><br><span class=\"line\">        - /usr/lib64/python2.7/lib-tk</span><br><span class=\"line\">        - /usr/lib64/python2.7/lib-old</span><br><span class=\"line\">        - /usr/lib64/python2.7/lib-dynload</span><br><span class=\"line\">        - /usr/lib64/python2.7/site-packages</span><br><span class=\"line\">        - /usr/lib/python2.7/site-packages</span><br><span class=\"line\">    pythonversion:</span><br><span class=\"line\">        - 2</span><br><span class=\"line\">        - 7</span><br><span class=\"line\">        - 5</span><br><span class=\"line\">        - final</span><br><span class=\"line\">        - 0</span><br><span class=\"line\">    saltpath:</span><br><span class=\"line\">        /usr/lib/python2.7/site-packages/salt</span><br><span class=\"line\">    saltversion:</span><br><span class=\"line\">        2018.3.2</span><br><span class=\"line\">    saltversioninfo:</span><br><span class=\"line\">        - 2018</span><br><span class=\"line\">        - 3</span><br><span class=\"line\">        - 2</span><br><span class=\"line\">        - 0</span><br><span class=\"line\">    selinux:</span><br><span class=\"line\">        ----------</span><br><span class=\"line\">        enabled:</span><br><span class=\"line\">            True</span><br><span class=\"line\">        enforced:</span><br><span class=\"line\">            Enforcing</span><br><span class=\"line\">    serialnumber:</span><br><span class=\"line\">        Parallels-4B 59 59 47 C0 77 4F C0 B6 29 EE 0B 4D A6 FD BE</span><br><span class=\"line\">    server_id:</span><br><span class=\"line\">        2082849409</span><br><span class=\"line\">    shell:</span><br><span class=\"line\">        /bin/bash</span><br><span class=\"line\">    swap_total:</span><br><span class=\"line\">        2047</span><br><span class=\"line\">    systemd:</span><br><span class=\"line\">        ----------</span><br><span class=\"line\">        features:</span><br><span class=\"line\">            +PAM +AUDIT +SELINUX +IMA -APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ +LZ4 -SECCOMP +BLKID +ELFUTILS +KMOD +IDN</span><br><span class=\"line\">        version:</span><br><span class=\"line\">            219</span><br><span class=\"line\">    uid:</span><br><span class=\"line\">        0</span><br><span class=\"line\">    username:</span><br><span class=\"line\">        root</span><br><span class=\"line\">    uuid:</span><br><span class=\"line\">        4759594b-77c0-c04f-b629-ee0b4da6fdbe</span><br><span class=\"line\">    virtual:</span><br><span class=\"line\">        Parallels</span><br><span class=\"line\">    zfs_feature_flags:</span><br><span class=\"line\">        False</span><br><span class=\"line\">    zfs_support:</span><br><span class=\"line\">        False</span><br><span class=\"line\">    zmqversion:</span><br><span class=\"line\">        4.1.4</span><br></pre></td></tr></table></figure>\n\n<p>\b# Pillar</p>\n<p>Pillar主要用于master端分发给minion端的信息，针对于Grains不同的是它是<code>动态加密</code>传输的，而且只有指定minion才能收到这些pillar信息。</p>\n<p>通过<code>salt &#39;*&#39; pillar.items</code> \b来展示pillar信息，通过<code>salt &#39;*&#39; saltutil.refresh_pillar</code> 来刷新pillar信息。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">newdev:</span><br><span class=\"line\">    ----------</span><br><span class=\"line\">    groups:</span><br><span class=\"line\">        |_</span><br><span class=\"line\">          ----------</span><br><span class=\"line\">          name:</span><br><span class=\"line\">              dev</span><br><span class=\"line\">          nodes:</span><br><span class=\"line\">              - dev</span><br><span class=\"line\">              - newdev</span><br><span class=\"line\">    sshd_port:</span><br><span class=\"line\">        22</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"High-State-与-Low-State\"><a href=\"#High-State-与-Low-State\" class=\"headerlink\" title=\"High State 与 Low State\"></a>High State 与 Low State</h1><p>如果什么配置都没问题以后可以通过 <code>salt &#39;*&#39; state.highstate</code> 完成所有机器的部署动作。</p>\n","path":"2018/08/09/2018-08-09-SaltStack知识整理/","permalink":"https://yuekang.org.cn/2018/08/09/2018-08-09-SaltStack%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86/","tags":[{"name":"运维","_id":"cm0q19pg4005gw8sne27p5ydt","slug":"运维","path":"tags/运维/","permalink":"https://yuekang.org.cn/tags/%E8%BF%90%E7%BB%B4/","length":6},{"name":"saltStack","_id":"cm0q19pg4005hw8sn119a8cr9","slug":"saltStack","path":"tags/saltStack/","permalink":"https://yuekang.org.cn/tags/saltStack/","length":2},{"name":"django","_id":"cm0q19pg5005tw8sng48t1ia3","slug":"django","path":"tags/django/","permalink":"https://yuekang.org.cn/tags/django/","length":1}],"categories":[],"prev":{"title":"HAProxy搭建","date":"2018-09-25T03:35:13.000Z","slug":"2018-09-25-HAProxy搭建","published":true,"updated":"2024-09-02T09:06:11.429Z","_id":"cm0q19pfm0023w8sn2loo0ava","layout":"post","photos":[],"excerpt":"","path":"2018/09/25/2018-09-25-HAProxy搭建/","permalink":"https://yuekang.org.cn/2018/09/25/2018-09-25-HAProxy%E6%90%AD%E5%BB%BA/","__post":true},"next":{"title":"Zend虚拟机学习","date":"2018-08-05T13:17:47.000Z","slug":"2018-08-05-Zend虚拟机学习","published":true,"updated":"2024-09-08T06:12:12.627Z","_id":"cm0q19pff0020w8sn2w0wasec","layout":"post","photos":[],"excerpt":"","path":"2018/08/05/2018-08-05-Zend虚拟机学习/","permalink":"https://yuekang.org.cn/2018/08/05/2018-08-05-Zend%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AD%A6%E4%B9%A0/","__post":true},"__post":true}