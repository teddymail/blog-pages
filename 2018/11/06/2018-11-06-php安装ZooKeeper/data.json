{"title":"php安装ZooKeeper","date":"2018-11-06T11:22:30.000Z","source":"_posts/2018-11-06.php安装ZooKeeper.md","raw":"---\ntitle: php安装ZooKeeper\ndate: 2018-11-06 19:22:30\ntags: [zookeeper,分布式]\n---\n\n>上一篇说了zookeeper的搭建，现在就得在php环境中使用上它，`\"ZooKeeper\"`是Java开发的对java支持比较好，如果php想使用上必须安装其c扩展才可以使用\n\n## 一、基础环境软件包准备\n\n1. Lib Zookeeper\n包下载地址： [http://zookeeper.apache.org/releases.html](http://zookeeper.apache.org/releases.html)\n\n\n```\nwget  http://mirror.bit.edu.cn/apache/zookeeper/zookeeper-3.4.13/zookeeper-3.4.13.tar.gz\n```\n2. PHP Zookeeper\n\n包下载页：[http://pecl.php.net/package/zookeeper](http://pecl.php.net/package/zookeeper)\n```\nwget http://pecl.php.net/get/zookeeper-0.5.0.tgz\n```\n\n\n### \b二、 环境安装\n\n\n1. libZookeeper安装\n\n```\nwget  http://mirror.bit.edu.cn/apache/zookeeper/zookeeper-3.4.13/zookeeper-3.4.13.tar.gz\ntar zxvf zookeeper-3.4.13.tar.gz\ncd zookeeper-3.4.13/src/c\n./configure prefix=/usr/local/zookeeper-lib\n\n//libtool: warning: remember to run 'libtool --finish /usr/local/lib' \n\nmake && make install\n```\n\n2. \bphp Zookeeper安装\n\n```\nwget http://pecl.php.net/get/zookeeper-0.5.0.tgz\ntar zxvf zookeeper-0.5.0.tgz\ncd zookeeper-0.5.0\nphpize\n./configure --with-php-config=/usr/bin/php-config  --with-libzookeeper-dir=/usr/local/zookeeper-lib/\n\nmake && make install\n\n```\n\n### 三、shell安装脚本编写\n\n```\n#!/bin/bash\n# Author: yuekang <iyuekang AT gmail.com>\n# Notes: 此脚本专用用于php安装zookeeper安装\n\nexport PATH=/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/sbin:/usr/local/bin\nclear\nprintf \"\n#######################################################################\n#            zookeeper Extension Install shell                        #\n#                   For online use only                               #\n#######################################################################\n\"\n# Check if user is root\n[ $(id -u) != '0' ] && { echo \"${CFAILURE}Error: You must be root to run this script${CEND}\"; exit 1; }\n\nphp_install_dir=\"/usr/local/php\"\n\n# Check PHP\nif [ -e \"${php_install_dir}/bin/phpize\" ]; then\n  phpExtensionDir=$(${php_install_dir}/bin/php-config --extension-dir)\n  PHP_detail_ver=$(${php_install_dir}/bin/php -r 'echo PHP_VERSION;')\n  PHP_main_ver=${PHP_detail_ver%.*}\nfi\n\n# 安装zookeeper Lib库\ninstall_Zookeeper_lib() {\n        src_url=\"http://mirror.bit.edu.cn/apache/zookeeper/zookeeper-3.4.13/zookeeper-3.4.13.tar.gz\" && Download_src\n        tar zxvf zookeeper-3.4.13.tar.gz\n        cd zookeeper-3.4.13/src/c\n        ./configure prefix=/usr/local/zookeeper-lib\n        make && make install\n        cd\n        rm -r zookeeper-3.4.13.tar.gz && rm -rf zookeeper-3.4.13\n\n}\n\n# 安装zookeeper扩展\ninstall_Zookeeper_extension() {\n        PHP_extension=\"zookeeper\"\n        src_url=\"http://pecl.php.net/get/zookeeper-0.5.0.tgz\" && Download_src\n        tar zxvf zookeeper-0.5.0.tgz\n        cd zookeeper-0.5.0\n        ${php_install_dir}/bin/phpize\n        ./configure --with-php-config=\"${php_install_dir}/bin/php-config\"  --with-libzookeeper-dir=/usr/local/zookeeper-lib/\n        make && make install\n        # 加载so组件\n        echo \"extension=${PHP_extension}.so\" > ${php_install_dir}/etc/php.d/${PHP_extension}.ini\n        cd\n        rm -r zookeeper-0.5.0.tgz && rm -rf zookeeper-0.5.0\n}\n\nDownload_src() {\n  [ -s \"${src_url##*/}\" ] && echo \"[${CMSG}${src_url##*/}${CEND}] found\" || { wget --limit-rate=10M -4 --tries=6 -c --no-check-certificate ${src_url}; sleep 1; }\n  if [ ! -e \"${src_url##*/}\" ]; then\n    echo \"${CFAILURE}Auto download failed! You can manually download ${src_url} into the src directory.${CEND}\"\n    kill -9 $$ll\n  fi\n}\n\n# Check succ\nCheck_succ() {\n  [ -f \"${phpExtensionDir}/${PHP_extension}.so\" ] && { echo;echo \"${CSUCCESS}PHP ${PHP_extension} module installed successfully! ${CEND}\"; }\n}\n\ninstall_Zookeeper_lib\ninstall_Zookeeper_extension\nCheck_succ\n```\n\n\n\n ","slug":"2018-11-06-php安装ZooKeeper","published":true,"updated":"2024-09-02T09:06:11.430Z","_id":"cm0ozs0d0002dkgsn5ao142ha","comments":true,"layout":"post","photos":[],"html":"<blockquote>\n<p>上一篇说了zookeeper的搭建，现在就得在php环境中使用上它，<code>&quot;ZooKeeper&quot;</code>是Java开发的对java支持比较好，如果php想使用上必须安装其c扩展才可以使用</p>\n</blockquote>\n<h2 id=\"一、基础环境软件包准备\"><a href=\"#一、基础环境软件包准备\" class=\"headerlink\" title=\"一、基础环境软件包准备\"></a>一、基础环境软件包准备</h2><ol>\n<li>Lib Zookeeper<br>包下载地址： <a href=\"http://zookeeper.apache.org/releases.html\">http://zookeeper.apache.org/releases.html</a></li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget  http://mirror.bit.edu.cn/apache/zookeeper/zookeeper-3.4.13/zookeeper-3.4.13.tar.gz</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>PHP Zookeeper</li>\n</ol>\n<p>包下载页：<a href=\"http://pecl.php.net/package/zookeeper\">http://pecl.php.net/package/zookeeper</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://pecl.php.net/get/zookeeper-0.5.0.tgz</span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"二、-环境安装\"><a href=\"#二、-环境安装\" class=\"headerlink\" title=\"\b二、 环境安装\"></a>\b二、 环境安装</h3><ol>\n<li>libZookeeper安装</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget  http://mirror.bit.edu.cn/apache/zookeeper/zookeeper-3.4.13/zookeeper-3.4.13.tar.gz</span><br><span class=\"line\">tar zxvf zookeeper-3.4.13.tar.gz</span><br><span class=\"line\">cd zookeeper-3.4.13/src/c</span><br><span class=\"line\">./configure prefix=/usr/local/zookeeper-lib</span><br><span class=\"line\"></span><br><span class=\"line\">//libtool: warning: remember to run &#x27;libtool --finish /usr/local/lib&#x27; </span><br><span class=\"line\"></span><br><span class=\"line\">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>\bphp Zookeeper安装</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://pecl.php.net/get/zookeeper-0.5.0.tgz</span><br><span class=\"line\">tar zxvf zookeeper-0.5.0.tgz</span><br><span class=\"line\">cd zookeeper-0.5.0</span><br><span class=\"line\">phpize</span><br><span class=\"line\">./configure --with-php-config=/usr/bin/php-config  --with-libzookeeper-dir=/usr/local/zookeeper-lib/</span><br><span class=\"line\"></span><br><span class=\"line\">make &amp;&amp; make install</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"三、shell安装脚本编写\"><a href=\"#三、shell安装脚本编写\" class=\"headerlink\" title=\"三、shell安装脚本编写\"></a>三、shell安装脚本编写</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\"># Author: yuekang &lt;iyuekang AT gmail.com&gt;</span><br><span class=\"line\"># Notes: 此脚本专用用于php安装zookeeper安装</span><br><span class=\"line\"></span><br><span class=\"line\">export PATH=/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/sbin:/usr/local/bin</span><br><span class=\"line\">clear</span><br><span class=\"line\">printf &quot;</span><br><span class=\"line\">#######################################################################</span><br><span class=\"line\">#            zookeeper Extension Install shell                        #</span><br><span class=\"line\">#                   For online use only                               #</span><br><span class=\"line\">#######################################################################</span><br><span class=\"line\">&quot;</span><br><span class=\"line\"># Check if user is root</span><br><span class=\"line\">[ $(id -u) != &#x27;0&#x27; ] &amp;&amp; &#123; echo &quot;$&#123;CFAILURE&#125;Error: You must be root to run this script$&#123;CEND&#125;&quot;; exit 1; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">php_install_dir=&quot;/usr/local/php&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"># Check PHP</span><br><span class=\"line\">if [ -e &quot;$&#123;php_install_dir&#125;/bin/phpize&quot; ]; then</span><br><span class=\"line\">  phpExtensionDir=$($&#123;php_install_dir&#125;/bin/php-config --extension-dir)</span><br><span class=\"line\">  PHP_detail_ver=$($&#123;php_install_dir&#125;/bin/php -r &#x27;echo PHP_VERSION;&#x27;)</span><br><span class=\"line\">  PHP_main_ver=$&#123;PHP_detail_ver%.*&#125;</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"># 安装zookeeper Lib库</span><br><span class=\"line\">install_Zookeeper_lib() &#123;</span><br><span class=\"line\">        src_url=&quot;http://mirror.bit.edu.cn/apache/zookeeper/zookeeper-3.4.13/zookeeper-3.4.13.tar.gz&quot; &amp;&amp; Download_src</span><br><span class=\"line\">        tar zxvf zookeeper-3.4.13.tar.gz</span><br><span class=\"line\">        cd zookeeper-3.4.13/src/c</span><br><span class=\"line\">        ./configure prefix=/usr/local/zookeeper-lib</span><br><span class=\"line\">        make &amp;&amp; make install</span><br><span class=\"line\">        cd</span><br><span class=\"line\">        rm -r zookeeper-3.4.13.tar.gz &amp;&amp; rm -rf zookeeper-3.4.13</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"># 安装zookeeper扩展</span><br><span class=\"line\">install_Zookeeper_extension() &#123;</span><br><span class=\"line\">        PHP_extension=&quot;zookeeper&quot;</span><br><span class=\"line\">        src_url=&quot;http://pecl.php.net/get/zookeeper-0.5.0.tgz&quot; &amp;&amp; Download_src</span><br><span class=\"line\">        tar zxvf zookeeper-0.5.0.tgz</span><br><span class=\"line\">        cd zookeeper-0.5.0</span><br><span class=\"line\">        $&#123;php_install_dir&#125;/bin/phpize</span><br><span class=\"line\">        ./configure --with-php-config=&quot;$&#123;php_install_dir&#125;/bin/php-config&quot;  --with-libzookeeper-dir=/usr/local/zookeeper-lib/</span><br><span class=\"line\">        make &amp;&amp; make install</span><br><span class=\"line\">        # 加载so组件</span><br><span class=\"line\">        echo &quot;extension=$&#123;PHP_extension&#125;.so&quot; &gt; $&#123;php_install_dir&#125;/etc/php.d/$&#123;PHP_extension&#125;.ini</span><br><span class=\"line\">        cd</span><br><span class=\"line\">        rm -r zookeeper-0.5.0.tgz &amp;&amp; rm -rf zookeeper-0.5.0</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Download_src() &#123;</span><br><span class=\"line\">  [ -s &quot;$&#123;src_url##*/&#125;&quot; ] &amp;&amp; echo &quot;[$&#123;CMSG&#125;$&#123;src_url##*/&#125;$&#123;CEND&#125;] found&quot; || &#123; wget --limit-rate=10M -4 --tries=6 -c --no-check-certificate $&#123;src_url&#125;; sleep 1; &#125;</span><br><span class=\"line\">  if [ ! -e &quot;$&#123;src_url##*/&#125;&quot; ]; then</span><br><span class=\"line\">    echo &quot;$&#123;CFAILURE&#125;Auto download failed! You can manually download $&#123;src_url&#125; into the src directory.$&#123;CEND&#125;&quot;</span><br><span class=\"line\">    kill -9 $$ll</span><br><span class=\"line\">  fi</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"># Check succ</span><br><span class=\"line\">Check_succ() &#123;</span><br><span class=\"line\">  [ -f &quot;$&#123;phpExtensionDir&#125;/$&#123;PHP_extension&#125;.so&quot; ] &amp;&amp; &#123; echo;echo &quot;$&#123;CSUCCESS&#125;PHP $&#123;PHP_extension&#125; module installed successfully! $&#123;CEND&#125;&quot;; &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">install_Zookeeper_lib</span><br><span class=\"line\">install_Zookeeper_extension</span><br><span class=\"line\">Check_succ</span><br></pre></td></tr></table></figure>\n\n\n\n","excerpt":"","more":"<blockquote>\n<p>上一篇说了zookeeper的搭建，现在就得在php环境中使用上它，<code>&quot;ZooKeeper&quot;</code>是Java开发的对java支持比较好，如果php想使用上必须安装其c扩展才可以使用</p>\n</blockquote>\n<h2 id=\"一、基础环境软件包准备\"><a href=\"#一、基础环境软件包准备\" class=\"headerlink\" title=\"一、基础环境软件包准备\"></a>一、基础环境软件包准备</h2><ol>\n<li>Lib Zookeeper<br>包下载地址： <a href=\"http://zookeeper.apache.org/releases.html\">http://zookeeper.apache.org/releases.html</a></li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget  http://mirror.bit.edu.cn/apache/zookeeper/zookeeper-3.4.13/zookeeper-3.4.13.tar.gz</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>PHP Zookeeper</li>\n</ol>\n<p>包下载页：<a href=\"http://pecl.php.net/package/zookeeper\">http://pecl.php.net/package/zookeeper</a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://pecl.php.net/get/zookeeper-0.5.0.tgz</span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"二、-环境安装\"><a href=\"#二、-环境安装\" class=\"headerlink\" title=\"\b二、 环境安装\"></a>\b二、 环境安装</h3><ol>\n<li>libZookeeper安装</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget  http://mirror.bit.edu.cn/apache/zookeeper/zookeeper-3.4.13/zookeeper-3.4.13.tar.gz</span><br><span class=\"line\">tar zxvf zookeeper-3.4.13.tar.gz</span><br><span class=\"line\">cd zookeeper-3.4.13/src/c</span><br><span class=\"line\">./configure prefix=/usr/local/zookeeper-lib</span><br><span class=\"line\"></span><br><span class=\"line\">//libtool: warning: remember to run &#x27;libtool --finish /usr/local/lib&#x27; </span><br><span class=\"line\"></span><br><span class=\"line\">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>\bphp Zookeeper安装</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://pecl.php.net/get/zookeeper-0.5.0.tgz</span><br><span class=\"line\">tar zxvf zookeeper-0.5.0.tgz</span><br><span class=\"line\">cd zookeeper-0.5.0</span><br><span class=\"line\">phpize</span><br><span class=\"line\">./configure --with-php-config=/usr/bin/php-config  --with-libzookeeper-dir=/usr/local/zookeeper-lib/</span><br><span class=\"line\"></span><br><span class=\"line\">make &amp;&amp; make install</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"三、shell安装脚本编写\"><a href=\"#三、shell安装脚本编写\" class=\"headerlink\" title=\"三、shell安装脚本编写\"></a>三、shell安装脚本编写</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\"># Author: yuekang &lt;iyuekang AT gmail.com&gt;</span><br><span class=\"line\"># Notes: 此脚本专用用于php安装zookeeper安装</span><br><span class=\"line\"></span><br><span class=\"line\">export PATH=/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/sbin:/usr/local/bin</span><br><span class=\"line\">clear</span><br><span class=\"line\">printf &quot;</span><br><span class=\"line\">#######################################################################</span><br><span class=\"line\">#            zookeeper Extension Install shell                        #</span><br><span class=\"line\">#                   For online use only                               #</span><br><span class=\"line\">#######################################################################</span><br><span class=\"line\">&quot;</span><br><span class=\"line\"># Check if user is root</span><br><span class=\"line\">[ $(id -u) != &#x27;0&#x27; ] &amp;&amp; &#123; echo &quot;$&#123;CFAILURE&#125;Error: You must be root to run this script$&#123;CEND&#125;&quot;; exit 1; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">php_install_dir=&quot;/usr/local/php&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"># Check PHP</span><br><span class=\"line\">if [ -e &quot;$&#123;php_install_dir&#125;/bin/phpize&quot; ]; then</span><br><span class=\"line\">  phpExtensionDir=$($&#123;php_install_dir&#125;/bin/php-config --extension-dir)</span><br><span class=\"line\">  PHP_detail_ver=$($&#123;php_install_dir&#125;/bin/php -r &#x27;echo PHP_VERSION;&#x27;)</span><br><span class=\"line\">  PHP_main_ver=$&#123;PHP_detail_ver%.*&#125;</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\"># 安装zookeeper Lib库</span><br><span class=\"line\">install_Zookeeper_lib() &#123;</span><br><span class=\"line\">        src_url=&quot;http://mirror.bit.edu.cn/apache/zookeeper/zookeeper-3.4.13/zookeeper-3.4.13.tar.gz&quot; &amp;&amp; Download_src</span><br><span class=\"line\">        tar zxvf zookeeper-3.4.13.tar.gz</span><br><span class=\"line\">        cd zookeeper-3.4.13/src/c</span><br><span class=\"line\">        ./configure prefix=/usr/local/zookeeper-lib</span><br><span class=\"line\">        make &amp;&amp; make install</span><br><span class=\"line\">        cd</span><br><span class=\"line\">        rm -r zookeeper-3.4.13.tar.gz &amp;&amp; rm -rf zookeeper-3.4.13</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"># 安装zookeeper扩展</span><br><span class=\"line\">install_Zookeeper_extension() &#123;</span><br><span class=\"line\">        PHP_extension=&quot;zookeeper&quot;</span><br><span class=\"line\">        src_url=&quot;http://pecl.php.net/get/zookeeper-0.5.0.tgz&quot; &amp;&amp; Download_src</span><br><span class=\"line\">        tar zxvf zookeeper-0.5.0.tgz</span><br><span class=\"line\">        cd zookeeper-0.5.0</span><br><span class=\"line\">        $&#123;php_install_dir&#125;/bin/phpize</span><br><span class=\"line\">        ./configure --with-php-config=&quot;$&#123;php_install_dir&#125;/bin/php-config&quot;  --with-libzookeeper-dir=/usr/local/zookeeper-lib/</span><br><span class=\"line\">        make &amp;&amp; make install</span><br><span class=\"line\">        # 加载so组件</span><br><span class=\"line\">        echo &quot;extension=$&#123;PHP_extension&#125;.so&quot; &gt; $&#123;php_install_dir&#125;/etc/php.d/$&#123;PHP_extension&#125;.ini</span><br><span class=\"line\">        cd</span><br><span class=\"line\">        rm -r zookeeper-0.5.0.tgz &amp;&amp; rm -rf zookeeper-0.5.0</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Download_src() &#123;</span><br><span class=\"line\">  [ -s &quot;$&#123;src_url##*/&#125;&quot; ] &amp;&amp; echo &quot;[$&#123;CMSG&#125;$&#123;src_url##*/&#125;$&#123;CEND&#125;] found&quot; || &#123; wget --limit-rate=10M -4 --tries=6 -c --no-check-certificate $&#123;src_url&#125;; sleep 1; &#125;</span><br><span class=\"line\">  if [ ! -e &quot;$&#123;src_url##*/&#125;&quot; ]; then</span><br><span class=\"line\">    echo &quot;$&#123;CFAILURE&#125;Auto download failed! You can manually download $&#123;src_url&#125; into the src directory.$&#123;CEND&#125;&quot;</span><br><span class=\"line\">    kill -9 $$ll</span><br><span class=\"line\">  fi</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"># Check succ</span><br><span class=\"line\">Check_succ() &#123;</span><br><span class=\"line\">  [ -f &quot;$&#123;phpExtensionDir&#125;/$&#123;PHP_extension&#125;.so&quot; ] &amp;&amp; &#123; echo;echo &quot;$&#123;CSUCCESS&#125;PHP $&#123;PHP_extension&#125; module installed successfully! $&#123;CEND&#125;&quot;; &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">install_Zookeeper_lib</span><br><span class=\"line\">install_Zookeeper_extension</span><br><span class=\"line\">Check_succ</span><br></pre></td></tr></table></figure>\n\n\n\n","path":"2018/11/06/2018-11-06-php安装ZooKeeper/","permalink":"https://yuekang.org.cn/2018/11/06/2018-11-06-php%E5%AE%89%E8%A3%85ZooKeeper/","tags":[{"name":"zookeeper","_id":"cm0ozs0dh006ckgsn5g2cfmjp","slug":"zookeeper","path":"tags/zookeeper/","permalink":"https://yuekang.org.cn/tags/zookeeper/","length":1},{"name":"分布式","_id":"cm0ozs0dh006ekgsnbik61uzw","slug":"分布式","path":"tags/分布式/","permalink":"https://yuekang.org.cn/tags/%E5%88%86%E5%B8%83%E5%BC%8F/","length":1}],"categories":[],"prev":{"title":"nginx上部署nginx-json-log来监控网站上接口的详细数据","date":"2018-11-12T02:55:49.000Z","slug":"2018-11-12-nginx上部署nginx-json-log来监控网站上接口的详细数据","published":true,"updated":"2024-09-02T09:06:11.431Z","_id":"cm0ozs0d0002ekgsn15y24vn1","layout":"post","photos":[],"excerpt":"","path":"2018/11/12/2018-11-12-nginx上部署nginx-json-log来监控网站上接口的详细数据/","permalink":"https://yuekang.org.cn/2018/11/12/2018-11-12-nginx%E4%B8%8A%E9%83%A8%E7%BD%B2nginx-json-log%E6%9D%A5%E7%9B%91%E6%8E%A7%E7%BD%91%E7%AB%99%E4%B8%8A%E6%8E%A5%E5%8F%A3%E7%9A%84%E8%AF%A6%E7%BB%86%E6%95%B0%E6%8D%AE/","__post":true},"next":{"title":"ZooKeeper集群化安装","date":"2018-11-05T07:51:13.000Z","slug":"2018-11-05-ZooKeeper集群化安装","published":true,"updated":"2024-09-02T09:06:11.430Z","_id":"cm0ozs0cz002akgsn7hq4ht91","layout":"post","photos":[],"excerpt":"","path":"2018/11/05/2018-11-05-ZooKeeper集群化安装/","permalink":"https://yuekang.org.cn/2018/11/05/2018-11-05-ZooKeeper%E9%9B%86%E7%BE%A4%E5%8C%96%E5%AE%89%E8%A3%85/","__post":true},"__post":true}