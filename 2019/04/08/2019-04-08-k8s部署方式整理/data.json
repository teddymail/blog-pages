{"title":"k8s部署方式整理","date":"2019-04-08T10:17:35.000Z","source":"_posts/2019-04-08.k8s部署方式整理_.md","raw":"---\ntitle: k8s部署方式整理 \ndate: 2019-04-08 18:17:35\ntags: [k8s,运维,部署]\n---\n\n>是不会方式多种多样\n\n\n## MicroK8s部署\n\n> MicroK8s适合单机测试环境，友好的操作体验可以很轻松的上手k8s集群控制和开发。\n\n```\n// MicroK8s 依赖 snapd工具需要第一个安装\nsudo yum install epel-release\nsudo yum install snapd\nsudo systemctl enable --now snapd.socket\nsudo ln -s /var/lib/snapd/snap /snap\n\n//通过snap工具安装microk8s\nsudo snap install microk8s --classic\nsnap info microk8s\n\n\n// 启动集群\nsudo microk8s.start\n//停止集群\nsudo microk8s.stop\n\n//查看所有容器启动情况\nmicrok8s.kubectl get all --all-namespaces                                               \nNAMESPACE     NAME                                                  READY   STATUS              RESTARTS   AGE\ndefault       pod/nginx-7db9fccd9b-7klhs                            0/1     ContainerCreating   0          76m\ndefault       pod/nginx-7db9fccd9b-8zjwg                            0/1     ContainerCreating   0          7\n\n//查看当前集群的编号和版本\n[root@k8smaster ~]# microk8s.kubectl get no\nNAME        STATUS   ROLES    AGE    VERSION\nk8smaster   Ready    <none>   109m   v1.14.0\n\n//监控当前所有容器工作状态\nwatch microk8s.kubectl get all --all-namespaces\n```\n\n![](http://img.yuekang.org.cn/2019040805.png)\n\n```\n//删除容器\nmicrok8s.kubectl delete deployment/nginx\ndeployment.extensions \"nginx\" deleted\n```\n\n\n## 以安装包的方式直接搭建\n\n\n### etcd服务\n\n> etcd 服务是作为k8s集群的主数据库，用来存放所有的容器状态的主数据库。\n\n```\n// 安装etcd\nyum install etcd\n\n// etcd配置文件, 默认监听在2379号端口\nvi /etc/etcd/etcd.conf\n//指定数据存放位置\nETCD_DATA_DIR=\"/var/lib/etcd/default.etcd\"\n//指定该节点名称\nETCD_NAME=\"master\"\n//指定客户端监听url，对外提供服务的地址\nETCD_LISTEN_CLIENT_URLS=\"http://localhost:2379\"\n//对外公告该客户端监听地址\nETCD_ADVERTISE_CLIENT_URLS=\"http://localhost:2379\"\n\n// 启动服务\nsystemctl daemon-reload\n\n// 启动服务\nsystemctl enable etcd.service\n\nsystemctl start etcd.service\n\n//验证etcd健康状态\netcdctl -C http://localhost:2379 cluster-health\nmember 8e9e05c52164694d is healthy: got healthy result from http://localhost:2379\ncluster is healthy\n\n```\n\n### k8s Mster 相关服务安装\n\n> 接下来将是我们非常重要的服务，k8s它有三个主要的服务：\n> 1. kube-apiserver服务\n> 2. kube-kube-controller-manager服务,依赖apiserver\n> 3. kube-scheduler服务,依赖apiserver\n\n```\n//三个服务都已经集成到kubernetes中了\nyum install kubernetes -y\n\n//配置kube-apiserver\nvi /etc/kubernetes/apiserver\nKUBE_API_ADDRESS=\"--insecure-bind-address=0.0.0.0\" \nKUBE_ETCD_SERVERS=\"--etcd-servers=http://127.0.0.1:2379\" \nKUBE_SERVICE_ADDRESSES=\"--service-cluster-ip-range=10.254.0.0/16\"\nKUBE_ADMISSION_CONTROL=\"--admission-control=NamespaceLifecycle,NamespaceExists,LimitRanger,SecurityContextDeny,ServiceAccount,ResourceQuota\"\nKUBE_API_ARGS=\"\n--insecure-port=8000\n--service-cluster-ip-range=169.169.0.0/16\n--service-node-port-range=1-65535\n-logtostderr=false\n--log-dir=/var/log/kubernetes\n-v=2\n\"\n\n\n\n//配置kube-controller-manager\nvi /etc/kubernetes/controller-manager\nKUBE_CONTROLLER_MANAGER_ARGS=\"\n--master=http://127.0.0.1:8000\n--logtostderr=false\n--v=2\n\"         \n\n//配置kube-scheduler\nvi /etc/kubernetes/scheduler\nKUBE_SCHEDULER_ARGS=\"\n-master=http://127.0.0.1:8000\n--logtostderr=false\n--log-dir=/var/log/kubernetes\n--v=2\n\" \n\n\n//k8s配置config\nvi /etc/kubernetes/config\nKUBE_LOGTOSTDERR=\"--logtostderr=true\" \nKUBE_LOG_LEVEL=\"--v=0\"\nKUBE_ALLOW_PRIV=\"--allow-privileged=false\"\nKUBE_MASTER=\"--master=http://127.0.0.1:8000\"\n\n\n//启动k8s各个组件\nsystemctl start kube-apiserver.service\nsystemctl start kube-controller-manager.service\nsystemctl start kube-scheduler.service\n\n//加入到系统服务中\nsystemctl enable kube-apiserver.service\nCreated symlink from /etc/systemd/system/multi-user.target.wants/kube-apiserver.service to /usr/lib/systemd/system/kube-apiserver.service.\n\nsystemctl enable kube-controller-manager.service\nCreated symlink from /etc/systemd/system/multi-user.target.wants/kube-controller-manager.service to /usr/lib/systemd/system/kube-controller-manager.service.\n\nsystemctl enable kube-scheduler.service\nCreated symlink from /etc/systemd/system/multi-user.target.wants/kube-scheduler.service to /usr/lib/systemd/system/kube-scheduler.service.\n\n```\n\n### k8s Worker服务搭建\n\n> \n\n```\n//安装服务\nyum install kubernetes -y\n\n//k8s配置\nvi /etc/kubernetes/config\n//指定master地址位置\nKUBE_MASTER=\"--master=http://127.0.0.1:8000\"\n\n//启动服务\nsystemctl enable kubelet.service\nsystemctl enable kube-proxy.service\n\n//配置master节点地址\nexport KUBERNETES_MASTER=http://centos-master:8080\n```","slug":"2019-04-08-k8s部署方式整理","published":true,"updated":"2024-09-02T09:06:11.433Z","_id":"cm0ov6iz0002uwjsn6y83alpp","comments":true,"layout":"post","photos":[],"html":"<blockquote>\n<p>是不会方式多种多样</p>\n</blockquote>\n<h2 id=\"MicroK8s部署\"><a href=\"#MicroK8s部署\" class=\"headerlink\" title=\"MicroK8s部署\"></a>MicroK8s部署</h2><blockquote>\n<p>MicroK8s适合单机测试环境，友好的操作体验可以很轻松的上手k8s集群控制和开发。</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">// MicroK8s 依赖 snapd工具需要第一个安装</span><br><span class=\"line\">sudo yum install epel-release</span><br><span class=\"line\">sudo yum install snapd</span><br><span class=\"line\">sudo systemctl enable --now snapd.socket</span><br><span class=\"line\">sudo ln -s /var/lib/snapd/snap /snap</span><br><span class=\"line\"></span><br><span class=\"line\">//通过snap工具安装microk8s</span><br><span class=\"line\">sudo snap install microk8s --classic</span><br><span class=\"line\">snap info microk8s</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">// 启动集群</span><br><span class=\"line\">sudo microk8s.start</span><br><span class=\"line\">//停止集群</span><br><span class=\"line\">sudo microk8s.stop</span><br><span class=\"line\"></span><br><span class=\"line\">//查看所有容器启动情况</span><br><span class=\"line\">microk8s.kubectl get all --all-namespaces                                               </span><br><span class=\"line\">NAMESPACE     NAME                                                  READY   STATUS              RESTARTS   AGE</span><br><span class=\"line\">default       pod/nginx-7db9fccd9b-7klhs                            0/1     ContainerCreating   0          76m</span><br><span class=\"line\">default       pod/nginx-7db9fccd9b-8zjwg                            0/1     ContainerCreating   0          7</span><br><span class=\"line\"></span><br><span class=\"line\">//查看当前集群的编号和版本</span><br><span class=\"line\">[root@k8smaster ~]# microk8s.kubectl get no</span><br><span class=\"line\">NAME        STATUS   ROLES    AGE    VERSION</span><br><span class=\"line\">k8smaster   Ready    &lt;none&gt;   109m   v1.14.0</span><br><span class=\"line\"></span><br><span class=\"line\">//监控当前所有容器工作状态</span><br><span class=\"line\">watch microk8s.kubectl get all --all-namespaces</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://img.yuekang.org.cn/2019040805.png\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">//删除容器</span><br><span class=\"line\">microk8s.kubectl delete deployment/nginx</span><br><span class=\"line\">deployment.extensions &quot;nginx&quot; deleted</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"以安装包的方式直接搭建\"><a href=\"#以安装包的方式直接搭建\" class=\"headerlink\" title=\"以安装包的方式直接搭建\"></a>以安装包的方式直接搭建</h2><h3 id=\"etcd服务\"><a href=\"#etcd服务\" class=\"headerlink\" title=\"etcd服务\"></a>etcd服务</h3><blockquote>\n<p>etcd 服务是作为k8s集群的主数据库，用来存放所有的容器状态的主数据库。</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">// 安装etcd</span><br><span class=\"line\">yum install etcd</span><br><span class=\"line\"></span><br><span class=\"line\">// etcd配置文件, 默认监听在2379号端口</span><br><span class=\"line\">vi /etc/etcd/etcd.conf</span><br><span class=\"line\">//指定数据存放位置</span><br><span class=\"line\">ETCD_DATA_DIR=&quot;/var/lib/etcd/default.etcd&quot;</span><br><span class=\"line\">//指定该节点名称</span><br><span class=\"line\">ETCD_NAME=&quot;master&quot;</span><br><span class=\"line\">//指定客户端监听url，对外提供服务的地址</span><br><span class=\"line\">ETCD_LISTEN_CLIENT_URLS=&quot;http://localhost:2379&quot;</span><br><span class=\"line\">//对外公告该客户端监听地址</span><br><span class=\"line\">ETCD_ADVERTISE_CLIENT_URLS=&quot;http://localhost:2379&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">// 启动服务</span><br><span class=\"line\">systemctl daemon-reload</span><br><span class=\"line\"></span><br><span class=\"line\">// 启动服务</span><br><span class=\"line\">systemctl enable etcd.service</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl start etcd.service</span><br><span class=\"line\"></span><br><span class=\"line\">//验证etcd健康状态</span><br><span class=\"line\">etcdctl -C http://localhost:2379 cluster-health</span><br><span class=\"line\">member 8e9e05c52164694d is healthy: got healthy result from http://localhost:2379</span><br><span class=\"line\">cluster is healthy</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"k8s-Mster-相关服务安装\"><a href=\"#k8s-Mster-相关服务安装\" class=\"headerlink\" title=\"k8s Mster 相关服务安装\"></a>k8s Mster 相关服务安装</h3><blockquote>\n<p>接下来将是我们非常重要的服务，k8s它有三个主要的服务：</p>\n<ol>\n<li>kube-apiserver服务</li>\n<li>kube-kube-controller-manager服务,依赖apiserver</li>\n<li>kube-scheduler服务,依赖apiserver</li>\n</ol>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">//三个服务都已经集成到kubernetes中了</span><br><span class=\"line\">yum install kubernetes -y</span><br><span class=\"line\"></span><br><span class=\"line\">//配置kube-apiserver</span><br><span class=\"line\">vi /etc/kubernetes/apiserver</span><br><span class=\"line\">KUBE_API_ADDRESS=&quot;--insecure-bind-address=0.0.0.0&quot; </span><br><span class=\"line\">KUBE_ETCD_SERVERS=&quot;--etcd-servers=http://127.0.0.1:2379&quot; </span><br><span class=\"line\">KUBE_SERVICE_ADDRESSES=&quot;--service-cluster-ip-range=10.254.0.0/16&quot;</span><br><span class=\"line\">KUBE_ADMISSION_CONTROL=&quot;--admission-control=NamespaceLifecycle,NamespaceExists,LimitRanger,SecurityContextDeny,ServiceAccount,ResourceQuota&quot;</span><br><span class=\"line\">KUBE_API_ARGS=&quot;</span><br><span class=\"line\">--insecure-port=8000</span><br><span class=\"line\">--service-cluster-ip-range=169.169.0.0/16</span><br><span class=\"line\">--service-node-port-range=1-65535</span><br><span class=\"line\">-logtostderr=false</span><br><span class=\"line\">--log-dir=/var/log/kubernetes</span><br><span class=\"line\">-v=2</span><br><span class=\"line\">&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">//配置kube-controller-manager</span><br><span class=\"line\">vi /etc/kubernetes/controller-manager</span><br><span class=\"line\">KUBE_CONTROLLER_MANAGER_ARGS=&quot;</span><br><span class=\"line\">--master=http://127.0.0.1:8000</span><br><span class=\"line\">--logtostderr=false</span><br><span class=\"line\">--v=2</span><br><span class=\"line\">&quot;         </span><br><span class=\"line\"></span><br><span class=\"line\">//配置kube-scheduler</span><br><span class=\"line\">vi /etc/kubernetes/scheduler</span><br><span class=\"line\">KUBE_SCHEDULER_ARGS=&quot;</span><br><span class=\"line\">-master=http://127.0.0.1:8000</span><br><span class=\"line\">--logtostderr=false</span><br><span class=\"line\">--log-dir=/var/log/kubernetes</span><br><span class=\"line\">--v=2</span><br><span class=\"line\">&quot; </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">//k8s配置config</span><br><span class=\"line\">vi /etc/kubernetes/config</span><br><span class=\"line\">KUBE_LOGTOSTDERR=&quot;--logtostderr=true&quot; </span><br><span class=\"line\">KUBE_LOG_LEVEL=&quot;--v=0&quot;</span><br><span class=\"line\">KUBE_ALLOW_PRIV=&quot;--allow-privileged=false&quot;</span><br><span class=\"line\">KUBE_MASTER=&quot;--master=http://127.0.0.1:8000&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">//启动k8s各个组件</span><br><span class=\"line\">systemctl start kube-apiserver.service</span><br><span class=\"line\">systemctl start kube-controller-manager.service</span><br><span class=\"line\">systemctl start kube-scheduler.service</span><br><span class=\"line\"></span><br><span class=\"line\">//加入到系统服务中</span><br><span class=\"line\">systemctl enable kube-apiserver.service</span><br><span class=\"line\">Created symlink from /etc/systemd/system/multi-user.target.wants/kube-apiserver.service to /usr/lib/systemd/system/kube-apiserver.service.</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl enable kube-controller-manager.service</span><br><span class=\"line\">Created symlink from /etc/systemd/system/multi-user.target.wants/kube-controller-manager.service to /usr/lib/systemd/system/kube-controller-manager.service.</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl enable kube-scheduler.service</span><br><span class=\"line\">Created symlink from /etc/systemd/system/multi-user.target.wants/kube-scheduler.service to /usr/lib/systemd/system/kube-scheduler.service.</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"k8s-Worker服务搭建\"><a href=\"#k8s-Worker服务搭建\" class=\"headerlink\" title=\"k8s Worker服务搭建\"></a>k8s Worker服务搭建</h3><blockquote>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">//安装服务</span><br><span class=\"line\">yum install kubernetes -y</span><br><span class=\"line\"></span><br><span class=\"line\">//k8s配置</span><br><span class=\"line\">vi /etc/kubernetes/config</span><br><span class=\"line\">//指定master地址位置</span><br><span class=\"line\">KUBE_MASTER=&quot;--master=http://127.0.0.1:8000&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">//启动服务</span><br><span class=\"line\">systemctl enable kubelet.service</span><br><span class=\"line\">systemctl enable kube-proxy.service</span><br><span class=\"line\"></span><br><span class=\"line\">//配置master节点地址</span><br><span class=\"line\">export KUBERNETES_MASTER=http://centos-master:8080</span><br></pre></td></tr></table></figure>","excerpt":"","more":"<blockquote>\n<p>是不会方式多种多样</p>\n</blockquote>\n<h2 id=\"MicroK8s部署\"><a href=\"#MicroK8s部署\" class=\"headerlink\" title=\"MicroK8s部署\"></a>MicroK8s部署</h2><blockquote>\n<p>MicroK8s适合单机测试环境，友好的操作体验可以很轻松的上手k8s集群控制和开发。</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">// MicroK8s 依赖 snapd工具需要第一个安装</span><br><span class=\"line\">sudo yum install epel-release</span><br><span class=\"line\">sudo yum install snapd</span><br><span class=\"line\">sudo systemctl enable --now snapd.socket</span><br><span class=\"line\">sudo ln -s /var/lib/snapd/snap /snap</span><br><span class=\"line\"></span><br><span class=\"line\">//通过snap工具安装microk8s</span><br><span class=\"line\">sudo snap install microk8s --classic</span><br><span class=\"line\">snap info microk8s</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">// 启动集群</span><br><span class=\"line\">sudo microk8s.start</span><br><span class=\"line\">//停止集群</span><br><span class=\"line\">sudo microk8s.stop</span><br><span class=\"line\"></span><br><span class=\"line\">//查看所有容器启动情况</span><br><span class=\"line\">microk8s.kubectl get all --all-namespaces                                               </span><br><span class=\"line\">NAMESPACE     NAME                                                  READY   STATUS              RESTARTS   AGE</span><br><span class=\"line\">default       pod/nginx-7db9fccd9b-7klhs                            0/1     ContainerCreating   0          76m</span><br><span class=\"line\">default       pod/nginx-7db9fccd9b-8zjwg                            0/1     ContainerCreating   0          7</span><br><span class=\"line\"></span><br><span class=\"line\">//查看当前集群的编号和版本</span><br><span class=\"line\">[root@k8smaster ~]# microk8s.kubectl get no</span><br><span class=\"line\">NAME        STATUS   ROLES    AGE    VERSION</span><br><span class=\"line\">k8smaster   Ready    &lt;none&gt;   109m   v1.14.0</span><br><span class=\"line\"></span><br><span class=\"line\">//监控当前所有容器工作状态</span><br><span class=\"line\">watch microk8s.kubectl get all --all-namespaces</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://img.yuekang.org.cn/2019040805.png\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">//删除容器</span><br><span class=\"line\">microk8s.kubectl delete deployment/nginx</span><br><span class=\"line\">deployment.extensions &quot;nginx&quot; deleted</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"以安装包的方式直接搭建\"><a href=\"#以安装包的方式直接搭建\" class=\"headerlink\" title=\"以安装包的方式直接搭建\"></a>以安装包的方式直接搭建</h2><h3 id=\"etcd服务\"><a href=\"#etcd服务\" class=\"headerlink\" title=\"etcd服务\"></a>etcd服务</h3><blockquote>\n<p>etcd 服务是作为k8s集群的主数据库，用来存放所有的容器状态的主数据库。</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">// 安装etcd</span><br><span class=\"line\">yum install etcd</span><br><span class=\"line\"></span><br><span class=\"line\">// etcd配置文件, 默认监听在2379号端口</span><br><span class=\"line\">vi /etc/etcd/etcd.conf</span><br><span class=\"line\">//指定数据存放位置</span><br><span class=\"line\">ETCD_DATA_DIR=&quot;/var/lib/etcd/default.etcd&quot;</span><br><span class=\"line\">//指定该节点名称</span><br><span class=\"line\">ETCD_NAME=&quot;master&quot;</span><br><span class=\"line\">//指定客户端监听url，对外提供服务的地址</span><br><span class=\"line\">ETCD_LISTEN_CLIENT_URLS=&quot;http://localhost:2379&quot;</span><br><span class=\"line\">//对外公告该客户端监听地址</span><br><span class=\"line\">ETCD_ADVERTISE_CLIENT_URLS=&quot;http://localhost:2379&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">// 启动服务</span><br><span class=\"line\">systemctl daemon-reload</span><br><span class=\"line\"></span><br><span class=\"line\">// 启动服务</span><br><span class=\"line\">systemctl enable etcd.service</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl start etcd.service</span><br><span class=\"line\"></span><br><span class=\"line\">//验证etcd健康状态</span><br><span class=\"line\">etcdctl -C http://localhost:2379 cluster-health</span><br><span class=\"line\">member 8e9e05c52164694d is healthy: got healthy result from http://localhost:2379</span><br><span class=\"line\">cluster is healthy</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"k8s-Mster-相关服务安装\"><a href=\"#k8s-Mster-相关服务安装\" class=\"headerlink\" title=\"k8s Mster 相关服务安装\"></a>k8s Mster 相关服务安装</h3><blockquote>\n<p>接下来将是我们非常重要的服务，k8s它有三个主要的服务：</p>\n<ol>\n<li>kube-apiserver服务</li>\n<li>kube-kube-controller-manager服务,依赖apiserver</li>\n<li>kube-scheduler服务,依赖apiserver</li>\n</ol>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">//三个服务都已经集成到kubernetes中了</span><br><span class=\"line\">yum install kubernetes -y</span><br><span class=\"line\"></span><br><span class=\"line\">//配置kube-apiserver</span><br><span class=\"line\">vi /etc/kubernetes/apiserver</span><br><span class=\"line\">KUBE_API_ADDRESS=&quot;--insecure-bind-address=0.0.0.0&quot; </span><br><span class=\"line\">KUBE_ETCD_SERVERS=&quot;--etcd-servers=http://127.0.0.1:2379&quot; </span><br><span class=\"line\">KUBE_SERVICE_ADDRESSES=&quot;--service-cluster-ip-range=10.254.0.0/16&quot;</span><br><span class=\"line\">KUBE_ADMISSION_CONTROL=&quot;--admission-control=NamespaceLifecycle,NamespaceExists,LimitRanger,SecurityContextDeny,ServiceAccount,ResourceQuota&quot;</span><br><span class=\"line\">KUBE_API_ARGS=&quot;</span><br><span class=\"line\">--insecure-port=8000</span><br><span class=\"line\">--service-cluster-ip-range=169.169.0.0/16</span><br><span class=\"line\">--service-node-port-range=1-65535</span><br><span class=\"line\">-logtostderr=false</span><br><span class=\"line\">--log-dir=/var/log/kubernetes</span><br><span class=\"line\">-v=2</span><br><span class=\"line\">&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">//配置kube-controller-manager</span><br><span class=\"line\">vi /etc/kubernetes/controller-manager</span><br><span class=\"line\">KUBE_CONTROLLER_MANAGER_ARGS=&quot;</span><br><span class=\"line\">--master=http://127.0.0.1:8000</span><br><span class=\"line\">--logtostderr=false</span><br><span class=\"line\">--v=2</span><br><span class=\"line\">&quot;         </span><br><span class=\"line\"></span><br><span class=\"line\">//配置kube-scheduler</span><br><span class=\"line\">vi /etc/kubernetes/scheduler</span><br><span class=\"line\">KUBE_SCHEDULER_ARGS=&quot;</span><br><span class=\"line\">-master=http://127.0.0.1:8000</span><br><span class=\"line\">--logtostderr=false</span><br><span class=\"line\">--log-dir=/var/log/kubernetes</span><br><span class=\"line\">--v=2</span><br><span class=\"line\">&quot; </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">//k8s配置config</span><br><span class=\"line\">vi /etc/kubernetes/config</span><br><span class=\"line\">KUBE_LOGTOSTDERR=&quot;--logtostderr=true&quot; </span><br><span class=\"line\">KUBE_LOG_LEVEL=&quot;--v=0&quot;</span><br><span class=\"line\">KUBE_ALLOW_PRIV=&quot;--allow-privileged=false&quot;</span><br><span class=\"line\">KUBE_MASTER=&quot;--master=http://127.0.0.1:8000&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">//启动k8s各个组件</span><br><span class=\"line\">systemctl start kube-apiserver.service</span><br><span class=\"line\">systemctl start kube-controller-manager.service</span><br><span class=\"line\">systemctl start kube-scheduler.service</span><br><span class=\"line\"></span><br><span class=\"line\">//加入到系统服务中</span><br><span class=\"line\">systemctl enable kube-apiserver.service</span><br><span class=\"line\">Created symlink from /etc/systemd/system/multi-user.target.wants/kube-apiserver.service to /usr/lib/systemd/system/kube-apiserver.service.</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl enable kube-controller-manager.service</span><br><span class=\"line\">Created symlink from /etc/systemd/system/multi-user.target.wants/kube-controller-manager.service to /usr/lib/systemd/system/kube-controller-manager.service.</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl enable kube-scheduler.service</span><br><span class=\"line\">Created symlink from /etc/systemd/system/multi-user.target.wants/kube-scheduler.service to /usr/lib/systemd/system/kube-scheduler.service.</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"k8s-Worker服务搭建\"><a href=\"#k8s-Worker服务搭建\" class=\"headerlink\" title=\"k8s Worker服务搭建\"></a>k8s Worker服务搭建</h3><blockquote>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">//安装服务</span><br><span class=\"line\">yum install kubernetes -y</span><br><span class=\"line\"></span><br><span class=\"line\">//k8s配置</span><br><span class=\"line\">vi /etc/kubernetes/config</span><br><span class=\"line\">//指定master地址位置</span><br><span class=\"line\">KUBE_MASTER=&quot;--master=http://127.0.0.1:8000&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">//启动服务</span><br><span class=\"line\">systemctl enable kubelet.service</span><br><span class=\"line\">systemctl enable kube-proxy.service</span><br><span class=\"line\"></span><br><span class=\"line\">//配置master节点地址</span><br><span class=\"line\">export KUBERNETES_MASTER=http://centos-master:8080</span><br></pre></td></tr></table></figure>","path":"2019/04/08/2019-04-08-k8s部署方式整理/","permalink":"https://yuekang.org.cn/2019/04/08/2019-04-08-k8s%E9%83%A8%E7%BD%B2%E6%96%B9%E5%BC%8F%E6%95%B4%E7%90%86/","tags":[{"name":"运维","_id":"cm0ov6iz9005gwjsnc0kk050j","slug":"运维","path":"tags/运维/","permalink":"https://yuekang.org.cn/tags/%E8%BF%90%E7%BB%B4/","length":6},{"name":"k8s","_id":"cm0ov6izg0078wjsn0yxt69me","slug":"k8s","path":"tags/k8s/","permalink":"https://yuekang.org.cn/tags/k8s/","length":3},{"name":"部署","_id":"cm0ov6izi007pwjsn1u109yvt","slug":"部署","path":"tags/部署/","permalink":"https://yuekang.org.cn/tags/%E9%83%A8%E7%BD%B2/","length":1}],"categories":[],"prev":{"title":"搭建ES服务","date":"2020-01-03T17:56:51.000Z","slug":"2020-01-04-搭建ES服务","published":true,"updated":"2024-09-02T09:06:11.434Z","_id":"cm0ov6iz0002wwjsn57362hx1","layout":"post","photos":[],"excerpt":"","path":"2020/01/04/2020-01-04-搭建ES服务/","permalink":"https://yuekang.org.cn/2020/01/04/2020-01-04-%E6%90%AD%E5%BB%BAES%E6%9C%8D%E5%8A%A1/","__post":true},"next":{"title":"k8s关键术语和概念总结","date":"2019-04-08T02:29:54.000Z","slug":"2019-04-08-k8s关键术语和概念总结","published":true,"updated":"2024-09-02T09:06:11.433Z","_id":"cm0ov6iyz002swjsnckz17e0d","layout":"post","photos":[],"excerpt":"","path":"2019/04/08/2019-04-08-k8s关键术语和概念总结/","permalink":"https://yuekang.org.cn/2019/04/08/2019-04-08-k8s%E5%85%B3%E9%94%AE%E6%9C%AF%E8%AF%AD%E5%92%8C%E6%A6%82%E5%BF%B5%E6%80%BB%E7%BB%93/","__post":true},"__post":true}